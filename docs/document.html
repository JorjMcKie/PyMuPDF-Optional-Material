
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document &#8212; PyMuPDF 1.18.9 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Font" href="font.html" />
    <link rel="prev" title="DisplayList" href="displaylist.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="font.html" title="Font"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="displaylist.html" title="DisplayList"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PyMuPDF 1.18.9 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="classes.html" accesskey="U">Classes</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Document</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="document">
<span id="id1"></span><h1>Document<a class="headerlink" href="#document" title="Permalink to this headline">¶</a></h1>
<p>This class represents a document. It can be constructed from a file or from memory.</p>
<p>There exists the alias <em>open</em> for this class, i.e. <code class="docutils literal notranslate"><span class="pre">fitz.Document(...)</span></code> and <code class="docutils literal notranslate"><span class="pre">fitz.open(...)</span></code> do exactly the same thing.</p>
<p>For details on <strong>embedded files</strong> refer to Appendix 3.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starting with v1.17.0, a new page addressing mechanism for <strong>EPUB files only</strong> is supported. This document type is internally organized in chapters such that pages can most efficiently be found by their so-called “location”. The location is a tuple <em>(chapter, pno)</em> consisting of the chapter number and the page number <strong>in that chapter</strong>. Both numbers are zero-based.</p>
<p>While it is still possible to locate a page via its (absoute) number, doing so may mean that the complete EPUB document must be layouted before the page can be addressed. This may have a significant performance impact if the document is very large. Using the page’s <em>(chapter, pno)</em> prevents this from happening.</p>
<p>To maintain a consistent API, PyMuPDF supports the page <em>location</em> syntax for <strong>all file types</strong> – documents without this feature simply have just one chapter. <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a> and the equivalent index access now also support a <em>location</em> argument.</p>
<p>There are a number of methods for converting between page numbers and locations, for determining the chapter count, the page count per chapter, for computing the next and the previous locations, and the last page location of a document.</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Method / Attribute</strong></p></th>
<th class="head"><p><strong>Short Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.add_layer_config" title="Document.add_layer_config"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.add_layer_config()</span></code></a></p></td>
<td><p>PDF only: make new optional content configuration</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.add_ocg" title="Document.add_ocg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.add_ocg()</span></code></a></p></td>
<td><p>PDF only: add new optional content group</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a></p></td>
<td><p>gain access to an encrypted document</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a></p></td>
<td><p>check if incremental save is possible</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.chapter_page_count" title="Document.chapter_page_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.chapter_page_count()</span></code></a></p></td>
<td><p>number of pages in chapter</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.close" title="Document.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.close()</span></code></a></p></td>
<td><p>close the document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a></p></td>
<td><p>write a PDF version to memory</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a></p></td>
<td><p>PDF only: copy a page reference</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.del_toc_item" title="Document.del_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a></p></td>
<td><p>PDF only: remove a single TOC item</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a></p></td>
<td><p>PDF only: delete a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a></p></td>
<td><p>PDF only: delete a page range</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a></p></td>
<td><p>PDF only: add a new embedded file from buffer</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_count" title="Document.embfile_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_count()</span></code></a></p></td>
<td><p>PDF only: number of embedded files</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_del" title="Document.embfile_del"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_del()</span></code></a></p></td>
<td><p>PDF only: delete an embedded file entry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_get" title="Document.embfile_get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_get()</span></code></a></p></td>
<td><p>PDF only: extract an embedded file buffer</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_info" title="Document.embfile_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_info()</span></code></a></p></td>
<td><p>PDF only: metadata of an embedded file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_names" title="Document.embfile_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_names()</span></code></a></p></td>
<td><p>PDF only: list of embedded files</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_upd" title="Document.embfile_upd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_upd()</span></code></a></p></td>
<td><p>PDF only: change an embedded file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.find_bookmark" title="Document.find_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.find_bookmark()</span></code></a></p></td>
<td><p>retrieve page location after layouting</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.fullcopy_page" title="Document.fullcopy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.fullcopy_page()</span></code></a></p></td>
<td><p>PDF only: duplicate a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_oc_states" title="Document.get_oc_states"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_oc_states()</span></code></a></p></td>
<td><p>PDF only: lists of OCGs in ON, OFF, RBGroups</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_oc" title="Document.get_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_oc()</span></code></a></p></td>
<td><p>PDF only: get OCG /OCMD xref of image / form xobject</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_ocgs" title="Document.get_ocgs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_ocgs()</span></code></a></p></td>
<td><p>PDF only: info on all optional content groups</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_ocmd" title="Document.get_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_ocmd()</span></code></a></p></td>
<td><p>PDF only: retrieve definition of an <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_fonts" title="Document.get_page_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_fonts()</span></code></a></p></td>
<td><p>PDF only: make a list of fonts on a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a></p></td>
<td><p>PDF only: make a list of images on a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_labels" title="Document.get_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_labels()</span></code></a></p></td>
<td><p>PDF only: list of page label definitions</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_numbers" title="Document.get_page_numbers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_numbers()</span></code></a></p></td>
<td><p>PDF only: get page numbers having a given label</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a></p></td>
<td><p>PDF only: make a list of XObjects on a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a></p></td>
<td><p>extract the table of contents</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_pixmap" title="Document.get_page_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_pixmap()</span></code></a></p></td>
<td><p>create a pixmap of a page by page number</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_text" title="Document.get_page_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_text()</span></code></a></p></td>
<td><p>extract the text of a page by page number</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_sigflags" title="Document.get_sigflags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_sigflags()</span></code></a></p></td>
<td><p>PDF only: determine signature state</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_xml_metadata" title="Document.get_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_xml_metadata()</span></code></a></p></td>
<td><p>PDF only: read the XML metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.has_annots" title="Document.has_annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_annots()</span></code></a></p></td>
<td><p>PDF only: check if PDF contains any annots</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.has_links" title="Document.has_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_links()</span></code></a></p></td>
<td><p>PDF only: check if PDF contains any links</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a></p></td>
<td><p>PDF only: insert a new page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a></p></td>
<td><p>PDF only: insert pages from another PDF</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.layer_configs" title="Document.layer_configs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_configs()</span></code></a></p></td>
<td><p>PDF only: list of optional content configurations</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.layer_ui_configs" title="Document.layer_ui_configs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_ui_configs()</span></code></a></p></td>
<td><p>PDF only: list of optional content intents</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.layout" title="Document.layout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layout()</span></code></a></p></td>
<td><p>re-paginate the document (if supported)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a></p></td>
<td><p>read a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.make_bookmark" title="Document.make_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.make_bookmark()</span></code></a></p></td>
<td><p>create a page pointer in reflowable documents</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_xml_metadata" title="Document.xref_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_xml_metadata()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of XML metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a></p></td>
<td><p>PDF only: move a page to different location in doc</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.need_appearances" title="Document.need_appearances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.need_appearances()</span></code></a></p></td>
<td><p>PDF only: get/set <code class="docutils literal notranslate"><span class="pre">/NeedAppearances</span></code> property</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a></p></td>
<td><p>PDF only: insert a new empty page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.next_location" title="Document.next_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a></p></td>
<td><p>return (chapter, pno) of following page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.outline_xref" title="Document.outline_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.outline_xref()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> a TOC item</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.page_cropbox" title="Document.page_cropbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.page_cropbox()</span></code></a></p></td>
<td><p>PDF only: the unrotated page rectangle</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.pages" title="Document.pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pages()</span></code></a></p></td>
<td><p>iterator over a page range</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.page_xref" title="Document.page_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.page_xref()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of a page number</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.pdf_catalog" title="Document.pdf_catalog"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pdf_catalog()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of catalog (root)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.pdf_trailer" title="Document.pdf_trailer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pdf_trailer()</span></code></a></p></td>
<td><p>PDF only: trailer source</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.prev_location" title="Document.prev_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a></p></td>
<td><p>return (chapter, pno) of preceeding page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.reload_page" title="Document.reload_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a></p></td>
<td><p>PDF only: provide a new copy of a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a></p></td>
<td><p>PDF only: save the document</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.saveIncr" title="Document.saveIncr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.saveIncr()</span></code></a></p></td>
<td><p>PDF only: save the document incrementally</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.scrub" title="Document.scrub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a></p></td>
<td><p>PDF only: remove sensitive data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.search_page_for" title="Document.search_page_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.search_page_for()</span></code></a></p></td>
<td><p>search for a string on a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a></p></td>
<td><p>PDF only: select a subset of pages</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_layer_ui_config" title="Document.set_layer_ui_config"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_layer_ui_config()</span></code></a></p></td>
<td><p>PDF only: set OCG visibility temporarily</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_metadata" title="Document.set_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_metadata()</span></code></a></p></td>
<td><p>PDF only: set the metadata</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_oc_states" title="Document.set_oc_states"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc_states()</span></code></a></p></td>
<td><p>PDF only: mass changing OCG states</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_oc" title="Document.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a></p></td>
<td><p>PDF only: attach OCG/OCMD to image / form xobject</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_ocmd" title="Document.set_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_ocmd()</span></code></a></p></td>
<td><p>PDF only: create or update an <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a></p></td>
<td><p>PDF only: add/update page label definitions</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_toc_item" title="Document.set_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc_item()</span></code></a></p></td>
<td><p>PDF only: change a single TOC item</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_toc" title="Document.set_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc()</span></code></a></p></td>
<td><p>PDF only: set the table of contents (TOC)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_xml_metadata" title="Document.set_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_xml_metadata()</span></code></a></p></td>
<td><p>PDF only: create or update document XML metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.subset_fonts" title="Document.subset_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a></p></td>
<td><p>PDF only: create font subsets <strong>(experimental)</strong></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.switch_layer" title="Document.switch_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.switch_layer()</span></code></a></p></td>
<td><p>PDF only: activate OC configuration</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></td>
<td><p>PDF only: writes document to memory</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a></p></td>
<td><p>PDF only: get the definition source of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.xref_get_key" title="Document.xref_get_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a></p></td>
<td><p>PDF only: get the value of a dictionary key</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a></p></td>
<td><p>PDF only: list the keys of object at <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.xref_set_key" title="Document.xref_set_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_set_key()</span></code></a></p></td>
<td><p>PDF only: set the value of a dictionary key</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_stream_raw" title="Document.xref_stream_raw"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_stream_raw()</span></code></a></p></td>
<td><p>PDF only: raw stream source at <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.chapter_count" title="Document.chapter_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a></p></td>
<td><p>number of chapters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.FormFonts" title="Document.FormFonts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.FormFonts</span></code></a></p></td>
<td><p>PDF only: list of global widget fonts</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_closed" title="Document.is_closed"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_closed</span></code></a></p></td>
<td><p>has document been closed?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_dirty" title="Document.is_dirty"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_dirty</span></code></a></p></td>
<td><p>PDF only: has document been changed yet?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_encrypted" title="Document.is_encrypted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a></p></td>
<td><p>document (still) encrypted?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_form_pdf" title="Document.is_form_pdf"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_form_pdf</span></code></a></p></td>
<td><p>is this a Form PDF?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id0" title="Document.is_pdf"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_pdf</span></code></a></p></td>
<td><p>is this a PDF?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_reflowable" title="Document.is_reflowable"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_reflowable</span></code></a></p></td>
<td><p>is this a reflowable document?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_repaired" title="Document.is_repaired"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_repaired</span></code></a></p></td>
<td><p>PDF only: has this PDF been repaired during open?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.last_location" title="Document.last_location"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.last_location</span></code></a></p></td>
<td><p>(chapter, pno) of last page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.metadata" title="Document.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.metadata</span></code></a></p></td>
<td><p>metadata</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.name" title="Document.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.name</span></code></a></p></td>
<td><p>filename of document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a></p></td>
<td><p>require password to access data?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.outline" title="Document.outline"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.outline</span></code></a></p></td>
<td><p>first <cite>Outline</cite> item</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.page_count</span></code></a></p></td>
<td><p>number of pages</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.permissions" title="Document.permissions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.permissions</span></code></a></p></td>
<td><p>permissions to access the document</p></td>
</tr>
</tbody>
</table>
<p><strong>Class API</strong></p>
<dl class="py class">
<dt id="Document">
<em class="property">class </em><code class="sig-name descname">Document</code><a class="headerlink" href="#Document" title="Permalink to this definition">¶</a></dt>
<dd><span class="target" id="index-0"></span><dl class="py method">
<dt id="Document.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">stream</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filetype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rect</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">height</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">11</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <em>Document</em> object.</p>
<ul class="simple">
<li><p>With default parameters, a <strong>new empty PDF</strong> document will be created.</p></li>
<li><p>If <em>stream</em> is given, then the document is created from memory and either <em>filename</em> or <em>filetype</em> must indicate its type.</p></li>
<li><p>If <em>stream</em> is <em>None</em>, then a document is created from the file given by <em>filename</em>. Its type is inferred from the extension, which can be overruled by specifying <em>filetype</em>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>,</em><em>pathlib</em>) – A UTF-8 string or <em>pathlib</em> object containing a file path (or a file type, see below).</p></li>
<li><p><strong>stream</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – <p>A memory area containing a supported document. Its type <strong>must</strong> be specified by either <em>filename</em> or <em>filetype</em>.</p>
<p><em>(Changed in version 1.14.13)</em> <em>io.BytesIO</em> is now also supported.</p>
</p></li>
<li><p><strong>filetype</strong> (<em>str</em>) – A string specifying the type of document. This may be something looking like a filename (e.g. “x.pdf”), in which case MuPDF uses the extension to determine the type, or a mime type like <em>application/pdf</em>. Just using strings like “pdf” will also work.</p></li>
<li><p><strong>rect</strong> (<em>rect_like</em>) – a rectangle specifying the desired page size. This parameter is only meaningful for documents with a variable page layout (“reflowable” documents), like e-books or HTML, and ignored otherwise. If specified, it must be a non-empty, finite rectangle with top-left coordinates (0, 0). Together with parameter <em>fontsize</em>, each page will be accordingly laid out and hence also determine the number of pages.</p></li>
<li><p><strong>width</strong> (<em>float</em>) – may used together with <em>height</em> as an alternative to <em>rect</em> to specify layout information.</p></li>
<li><p><strong>height</strong> (<em>float</em>) – may used together with <em>width</em> as an alternative to <em>rect</em> to specify layout information.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – the default fontsize for reflowable document types. This parameter is ignored if none of the parameters <em>rect</em> or <em>width</em> and <em>height</em> are specified. Will be used to calculate the page layout.</p></li>
</ul>
</dd>
</dl>
<p>Overview of possible forms (<em>open</em> is a synonym of <em>Document</em>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># from a file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.file&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;pdf&quot;</span><span class="p">)</span>  <span class="c1"># copes with wrong extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.file&quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">)</span>  <span class="c1"># copes with wrong extension</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># from memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">mem_area</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">mem_area</span><span class="p">,</span> <span class="s2">&quot;pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">mem_area</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># new empty PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>The Document class can be also be used as a <strong>context manager</strong>. On exit, the document will automatically be closed.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fitz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="k">as</span> <span class="n">doc</span><span class="p">:</span>
<span class="go">        for page in doc: print(&quot;page %i&quot; % page.number)</span>
<span class="go">page 0</span>
<span class="go">page 1</span>
<span class="go">page 2</span>
<span class="go">page 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">is_closed</span>
<span class="go">True</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.get_oc">
<code class="sig-name descname">get_oc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_oc" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.4)</em></p>
<p>Return the cross reference number of an <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> or <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> attached to an image or form xobject.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of an image or form xobject. Valid such cross reference numbers are returned by <a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a>, resp. <a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a>. For invalid numbers, an exception is raised.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the cross reference number of an optional contents object or zero if there is none.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.set_oc">
<code class="sig-name descname">set_oc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em>, <em class="sig-param"><span class="n">ocxref</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_oc" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.4)</em></p>
<p>If <em>xref</em> represents an image or form xobject, set or remove the cross reference number <em>ocxref</em> of an optional contents object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of an image or form xobject <a class="footnote-reference brackets" href="#f5" id="id2">5</a>. Valid such cross reference numbers are returned by <a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a>, resp. <a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a>. For invalid numbers, an exception is raised.</p></li>
<li><p><strong>ocxref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of an <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> / <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a>. If not zero, an invalid reference raises an exception. If zero, any OC reference is removed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.layer_configs">
<code class="sig-name descname">layer_configs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.layer_configs" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.3)</em></p>
<p>Show optional layer configurations. There always is a standard one, which is not included in the response.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">layer_configs</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="go">{&#39;number&#39;: 0, &#39;name&#39;: &#39;my-config&#39;, &#39;creator&#39;: &#39;&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use &#39;number&#39; as config identifyer in add_ocg</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.add_layer_config">
<code class="sig-name descname">add_layer_config</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">creator</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">on</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.add_layer_config" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.3)</em></p>
<p>Add an optional content configuration. Layers serve as a collection of ON / OFF states for optional content groups. They allow fast visibility switches between different views on the same document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – arbitrary name.</p></li>
<li><p><strong>creator</strong> (<em>str</em>) – creating software.</p></li>
<li><p><strong>on</strong> (<em>sequ</em>) – a sequence of OCG <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> numbers which should be set to ON (visible). All other OCGs will be set to OFF.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.switch_layer">
<code class="sig-name descname">switch_layer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">number</span></em>, <em class="sig-param"><span class="n">as_default</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.switch_layer" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.3)</em></p>
<p>Switch to a document view as defined by the optional layer’s configuration number. This is temporary, except if established as default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>int</em>) – config number as returned by <a class="reference internal" href="#Document.layer_configs" title="Document.layer_configs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_configs()</span></code></a>.</p></li>
<li><p><strong>as_default</strong> (<em>bool</em>) – make this the default configuration.</p></li>
</ul>
</dd>
</dl>
<p>Activates the ON / OFF states of OCGs as defined in the identified layer. If <em>as_default=True</em>, then additionally all layers, including the standard one, are merged and the result is written back to the standard layer, and <strong>all optional layers are deleted</strong>.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.add_ocg">
<code class="sig-name descname">add_ocg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">on</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">intent</span><span class="o">=</span><span class="default_value">'View'</span></em>, <em class="sig-param"><span class="n">usage</span><span class="o">=</span><span class="default_value">'Artwork'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.add_ocg" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.3)</em></p>
<p>Add an optional content group. An OCG is the most important unit of information to determine object visibility. For a PDF, in order to be regarded as having optional content, at least one OCG must exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – arbitrary name. Will show up in supporting PDF viewers.</p></li>
<li><p><strong>config</strong> (<em>int</em>) – layer configuration number. Default -1 is the standard configuration.</p></li>
<li><p><strong>on</strong> (<em>bool</em>) – standard visibility status for objects pointing to this OCG.</p></li>
<li><p><strong>intent</strong> (<em>str</em><em>,</em><em>list</em>) – a string or list of strings declaring the visibility intents. There are two PDF standard values to choose from: “View” and “Design”. Default is “View”. Correct <strong>spelling is important</strong>.</p></li>
<li><p><strong>usage</strong> (<em>str</em>) – another influencer for OCG visibility. This will become part of the OCG’s <code class="docutils literal notranslate"><span class="pre">/Usage</span></code> key. There are two PDF standard values to choose from: “Artwork” and “Technical”. Default is “Artwork”. Please only change when required.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the created OCG. Use as entry for <code class="docutils literal notranslate"><span class="pre">oc</span></code> parameter in supporting objects.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple OCGs with identical parameters may be created. This will not cause problems. Garbage option 3 of <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> will get rid of any duplicates.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.set_ocmd">
<code class="sig-name descname">set_ocmd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ocgs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">policy</span><span class="o">=</span><span class="default_value">'AnyOn'</span></em>, <em class="sig-param"><span class="n">ve</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_ocmd" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.4)</em></p>
<p>Create or update an <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> (optional content membership dictionary).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the OCMD to be updated, or 0 for a new OCMD.</p></li>
<li><p><strong>ocgs</strong> (<em>list</em>) – a sequence of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> numbers of existing <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> PDF objects.</p></li>
<li><p><strong>policy</strong> (<em>str</em>) – one of “AnyOn” (default), “AnyOff”, “AllOn”, “AllOff” (mixed or lower case).</p></li>
<li><p><strong>ve</strong> (<em>list</em>) – a “visibility expression”. This is a list of arbitrarily nested other lists – see explanation below. Use as an alternative to the combination <em>ocgs</em> / <em>policy</em> if you need to formulate more complex conditions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the OCMD. Use as <code class="docutils literal notranslate"><span class="pre">oc=xref</span></code> parameter in supporting objects, and respectively in <a class="reference internal" href="#Document.set_oc" title="Document.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a> or <a class="reference internal" href="annot.html#Annot.set_oc" title="Annot.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_oc()</span></code></a>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The purpose of OCMDs is to more flexibly determine visibility. An OCMD actually is a boolean expression: it evaluates the current visibility of one or more optional content groups and then computes its own ON (true) or OFF (false) state.</p>
<p>There are two ways to formulate the OCMD’s visibility:</p>
<ol class="arabic simple">
<li><p>Use the combination of <em>ocgs</em> and <em>policy</em>: The <em>policy</em> value is interpreted as follows:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>AnyOn – (default) true if at least one OCG is ON.</p></li>
<li><p>AnyOff – true if at least one OCG is OFF.</p></li>
<li><p>AllOn – true if all OCGs are ON.</p></li>
<li><p>AllOff – true if all OCGs are OFF.</p></li>
</ul>
<p>Suppose you want two PDF objects be displayed exactly one at a time (if one is ON, then the other one must be OFF):</p>
<p>Solution: use an <strong>OCG</strong> for object 1 and an <strong>OCMD</strong> for object 2. Create the OCMD via <code class="docutils literal notranslate"><span class="pre">set_ocmd(ocgs=[xref],</span> <span class="pre">policy=&quot;AllOff&quot;)</span></code>, with the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the OCG.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Use the <strong>visibility expression</strong> <em>ve</em>: This is a list of a logical expression keyword (string) followed by integers or other lists. The possible logical expressions are <strong>“and”</strong>, <strong>“or”</strong>, and <strong>“not”</strong>. The integers must be <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> numbers of OCGs. The syntax of this parameter is a bit awkward, but quite powerful:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Each list, including the top one, must start with a logical expression.</p></li>
<li><p>If the first item is a <strong>“not”</strong>, then the list must have exactly two items. If it is <strong>“and”</strong> or <strong>“or”</strong>, any number of other items may follow.</p></li>
<li><p>Items following the logical expression may be either integers or other lists. An <em>integer</em> must be the xref of an OCG. A <em>list</em> must conform to the rules above.</p></li>
</ul>
<p><strong>Examples:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">set_ocmd(ve=[&quot;or&quot;,</span> <span class="pre">4,</span> <span class="pre">[&quot;not&quot;,</span> <span class="pre">5],</span> <span class="pre">[&quot;and&quot;,</span> <span class="pre">6,</span> <span class="pre">7]])</span></code>. This delivers ON if the following is true: <strong>“4 is ON, or 5 is OFF, or 6 and 7 are both ON”</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_ocmd(ve=[&quot;not&quot;,</span> <span class="pre">xref])</span></code>. This has the same effect as the OCMD example created under 1.</p></li>
</ul>
<p>For more details and examples see page 367 of <a class="reference internal" href="app4.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>. Also do have a look at example scripts <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/optional-content">here</a>.</p>
<p>Visibility expressions, <code class="docutils literal notranslate"><span class="pre">/VE</span></code>, are part of the PDF version 1.6 specification. If you are using an older PDF consumer software, you hence may find it unsupported (i.e. ignored).</p>
</div></blockquote>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.get_ocmd">
<code class="sig-name descname">get_ocmd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_ocmd" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.4)</em></p>
<p>Retrieve the definition of an OCMD (optional content membership dictionary).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the OCMD.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a dictionary with the keys <em>xref</em>, <em>ocgs</em>, <em>policy</em> and <em>ve</em>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.get_oc_states">
<code class="sig-name descname">get_oc_states</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_oc_states" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.3)</em></p>
<p>List of optional content groups by status in the specified configuration. This is a dictionary with lists of cross reference numbers for OCGs that occur in the arrays <code class="docutils literal notranslate"><span class="pre">/ON</span></code>, <code class="docutils literal notranslate"><span class="pre">/OFF</span></code> or in some radio button group (<code class="docutils literal notranslate"><span class="pre">/RBGroups</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<em>int</em>) – the configuration layer (default is the standard config layer).</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_oc_states</span><span class="p">())</span>
<span class="go">{&#39;off&#39;: [8, 9, 10], &#39;on&#39;: [5, 6, 7], &#39;rbgroups&#39;: [[7, 10]]}</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.set_oc_states">
<code class="sig-name descname">set_oc_states</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span></em>, <em class="sig-param"><span class="n">on</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">off</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">basestate</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rbgroups</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_oc_states" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.3)</em></p>
<p>Mass status changes of optional content groups. <strong>Permanently</strong> sets the status of OCGs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>int</em>) – desired configuration layer, choose -1 for the default one.</p></li>
<li><p><strong>on</strong> (<em>list</em>) – list of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of OCGs to set ON. Replaces previous values. An empty list will cause no OCG being set to ON anymore. Should be specified if <code class="docutils literal notranslate"><span class="pre">basestate=&quot;ON&quot;</span></code> is used.</p></li>
<li><p><strong>off</strong> (<em>list</em>) – list of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of OCGs to set OFF. Replaces previous values. An empty list will cause no OCG being set to OFF anymore. Should be specified if <code class="docutils literal notranslate"><span class="pre">basestate=&quot;OFF&quot;</span></code> is used.</p></li>
<li><p><strong>basestate</strong> (<em>str</em>) – desired state of OCGs that are not mentioned in <em>on</em> resp. <em>off</em>. Possible values are “ON”, “OFF” or “Unchanged”. Upper / lower case possible.</p></li>
<li><p><strong>rbgroups</strong> (<em>list</em>) – a list of lists. Replaces previous values. Each sublist should contain two or more OCG xrefs. OCGs in the same sublist are handled like buttons in a radio button group: setting one to ON automatically sets all other group members to OFF.</p></li>
</ul>
</dd>
</dl>
<p>Values <em>None</em> will not change the corresponding PDF array.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_oc_states</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">basestate</span><span class="o">=</span><span class="s2">&quot;OFF&quot;</span><span class="p">)</span>  <span class="c1"># only changes the base state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_oc_states</span><span class="p">())</span>
<span class="go">{&#39;basestate&#39;: &#39;OFF&#39;, &#39;off&#39;: [8, 9, 10], &#39;on&#39;: [5, 6, 7], &#39;rbgroups&#39;: [[7, 10]]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.get_ocgs">
<code class="sig-name descname">get_ocgs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_ocgs" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.3)</em></p>
<p>Details of all optional content groups. This is a dictionary of dictionaries like this (key is the OCG’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_ocgs</span><span class="p">())</span>
<span class="go">{13: {&#39;on&#39;: True,</span>
<span class="go">      &#39;intent&#39;: [&#39;View&#39;, &#39;Design&#39;],</span>
<span class="go">      &#39;name&#39;: &#39;Circle&#39;,</span>
<span class="go">      &#39;usage&#39;: &#39;Artwork&#39;},</span>
<span class="go">14: {&#39;on&#39;: True,</span>
<span class="go">      &#39;intent&#39;: [&#39;View&#39;, &#39;Design&#39;],</span>
<span class="go">      &#39;name&#39;: &#39;Square&#39;,</span>
<span class="go">      &#39;usage&#39;: &#39;Artwork&#39;},</span>
<span class="go">15: {&#39;on&#39;: False, &#39;intent&#39;: [&#39;View&#39;], &#39;name&#39;: &#39;Square&#39;, &#39;usage&#39;: &#39;Artwork&#39;}}</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.layer_ui_configs">
<code class="sig-name descname">layer_ui_configs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.layer_ui_configs" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.3)</em></p>
<p>Show the visibility status of optional content that is modifyable by the user interface of supporting PDF viewers. Example:</p>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">layer_ui_configs</span><span class="p">())</span>
<span class="go"> ({&#39;depth&#39;: 0,</span>
<span class="go">  &#39;locked&#39;: False,</span>
<span class="go">  &#39;number&#39;: 0,</span>
<span class="go">  &#39;on&#39;: True,</span>
<span class="go">  &#39;text&#39;: &#39;Circle&#39;,</span>
<span class="go">  &#39;type&#39;: &#39;checkbox&#39;},</span>
<span class="go"> {&#39;depth&#39;: 0,</span>
<span class="go">  &#39;locked&#39;: False,</span>
<span class="go">  &#39;number&#39;: 1,</span>
<span class="go">  &#39;on&#39;: False,</span>
<span class="go">  &#39;text&#39;: &#39;Square&#39;,</span>
<span class="go">  &#39;type&#39;: &#39;checkbox&#39;})</span>
<span class="go"> &gt;&gt;&gt; # refers to OCGs named &quot;Circle&quot; (ON), resp. &quot;Square&quot; (OFF)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Only reports items contained in the currently selected layer configuration.</p></li>
<li><dl class="simple">
<dt>The meaning of the dictionary keys is as follows:</dt><dd><ul>
<li><p><em>depth:</em> item’s nesting level in the <cite>/Order</cite> array</p></li>
<li><p><em>locked:</em> whether changing the item’s state is prohibited</p></li>
<li><p><em>number:</em> running sequence number</p></li>
<li><p><em>on:</em> item state</p></li>
<li><p><em>text:</em> text string or name field of the originating OCG</p></li>
<li><p><em>type:</em> one of “label” (set by a text string), “checkbox” (set by a single OCG) or “radiobox” (set by a set of connected OCGs)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="Document.set_layer_ui_config">
<code class="sig-name descname">set_layer_ui_config</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">number</span></em>, <em class="sig-param"><span class="n">action</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_layer_ui_config" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.3)</em></p>
<p>Modify OC visibility status of content groups. This is analog to what supporting PDF viewers would offer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Visibility is <strong>not</strong> a property stored with the OCG. It is not even an information necessarily present in the PDF document at all. Instead, the current visibility is <strong>temporarily</strong> set using the user interface of some supporting PDF consumer software. The same type of functionality is offered by this method.</p>
<p>To make <strong>permanent</strong> changes, use <a class="reference internal" href="#Document.set_oc_states" title="Document.set_oc_states"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc_states()</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>in</em>) – number as returned by <a class="reference internal" href="#Document.layer_ui_configs" title="Document.layer_ui_configs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_ui_configs()</span></code></a>.</p></li>
<li><p><strong>action</strong> (<em>int</em>) – 0 = set on (default), 1 = toggle on/off, 2 = set off.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># let&#39;s make above &quot;Square&quot; visible:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_layer_ui_config</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">layer_ui_configs</span><span class="p">())</span>
<span class="go">({&#39;depth&#39;: 0,</span>
<span class="go">  &#39;locked&#39;: False,</span>
<span class="go">  &#39;number&#39;: 0,</span>
<span class="go">  &#39;on&#39;: True,</span>
<span class="go">  &#39;text&#39;: &#39;Circle&#39;,</span>
<span class="go">  &#39;type&#39;: &#39;checkbox&#39;},</span>
<span class="go">{&#39;depth&#39;: 0,</span>
<span class="go">  &#39;locked&#39;: False,</span>
<span class="go">  &#39;number&#39;: 1,</span>
<span class="go">  &#39;on&#39;: True,  # &lt;===</span>
<span class="go">  &#39;text&#39;: &#39;Square&#39;,</span>
<span class="go">  &#39;type&#39;: &#39;checkbox&#39;})</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.authenticate">
<code class="sig-name descname">authenticate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">password</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.authenticate" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypts the document with the string <em>password</em>. If successful, document data can be accessed. For PDF documents, the “owner” and the “user” have different priviledges, and hence different passwords may exist for these authorization levels. The method will automatically establish the appropriate access rights for the provided password.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>password</strong> (<em>str</em>) – owner or user password.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>a positive value if successful, zero otherwise. If positive, the indicator <a class="reference internal" href="#Document.is_encrypted" title="Document.is_encrypted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a> is set to <em>False</em>. Positive return codes carry the following information detail:</p>
<ul class="simple">
<li><p>bit 0 set =&gt; authenticated, but no password required – happens if method was used although <a class="reference internal" href="#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">needs_pass</span></code></a> was zero.</p></li>
<li><p>bit 1 set =&gt; authenticated with the <strong>user</strong> password.</p></li>
<li><p>bit 2 set =&gt; authenticated with the <strong>owner</strong> password.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.get_page_numbers">
<code class="sig-name descname">get_page_numbers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label</span></em>, <em class="sig-param"><span class="n">only_one</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v 1.18.6)</em></p>
<p>PDF only: Return a list of page numbers that have the specified label – note that labels may not be unique in a PDF. This implies a sequential search through <strong>all page numbers</strong> to compare their labels.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Implementation detail – pages are <strong>not loaded</strong> for this purpose.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – the label to look for, e.g. “vii” (Roman number 7).</p></li>
<li><p><strong>only_one</strong> (<em>bool</em>) – stop after first hit. Useful e.g. if labelling is known to be unique, there are many pages, etc. The default will check every page number.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of page numbers that have this label. Empty if none found, no labels defined, etc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.get_page_labels">
<code class="sig-name descname">get_page_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_labels" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.7)</em></p>
<p>PDF only: Extract the list of page label definitions. Typically used for modifications before feeding it into <a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of dictionaries as defined in <a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.set_page_labels">
<code class="sig-name descname">set_page_labels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">labels</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_page_labels" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.6)</em></p>
<p>PDF only: Add or update the page label definitions of the PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>labels</strong> (<em>list</em>) – <p>a list of dictionaries. Each dictionary defines a label building rule and a 0-based “start” page number. That start page number is the first for which the label definition is valid. Each dictionary has up to 4 items and looks like <code class="docutils literal notranslate"><span class="pre">{'startpage':</span> <span class="pre">int,</span> <span class="pre">'prefix':</span> <span class="pre">str,</span> <span class="pre">'style':</span> <span class="pre">str,</span> <span class="pre">'firstpagenum':</span> <span class="pre">int}</span></code> and has the following items.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">startpage</span></code>: (int) the first page number (0-based) to apply the label rule. This key <strong>must be present</strong>. The rule is applied to all subsequent pages until either end of document or superseded by the rule with the next larger page number.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prefix</span></code>: (str) an arbitrary string to start the label with, e.g. “A-“. Default is “”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">style</span></code>: (str) the numbering style. Available are “D” (decimal), “r”/”R” (Roman numbers, lower or upper case), and “a”/”A” (lower or upper case alphabetical numbering: “a” through “z”, then “aa” through “az”, etc.). Default is “”. If “”, no numbering will take place and the pages in that range will receive the same label consisting of the <code class="docutils literal notranslate"><span class="pre">prefix</span></code> value. If prefix is also omitted, then the label will be “”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">firstpagenum</span></code>: (int) start numbering with this value. Default is 1, smaller values are ignored.</p></li>
</ul>
</p>
</dd>
</dl>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;startpage&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;A-&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;firstpagenum&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;startpage&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;firstpagenum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}]</span>
</pre></div>
</div>
<p>will generate the labels “A-10”, “A-11”, “A-12”, “A-13”, “1”, “2”, “3”, … for pages 6, 7 and so on until end of document. Pages 0 through 5 will have the label “”.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.make_bookmark">
<code class="sig-name descname">make_bookmark</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">loc</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.make_bookmark" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v.1.17.3)</em> Return a page pointer in a reflowable document. After re-layouting the document, the result of this method can be used to find the new location of the page.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not confuse with items of a table of contents, TOC.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>loc</strong> (<em>list</em><em>,</em><em>tuple</em>) – page location. Must be a valid <em>(chapter, pno)</em>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pointer</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a long integer in pointer format. To be used for finding the new location of the page after re-layouting the document. Do not touch or re-assign.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.find_bookmark">
<code class="sig-name descname">find_bookmark</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bookmark</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.find_bookmark" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v.1.17.3)</em> Return the new page location after re-layouting the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bookmark</strong> (<em>pointer</em>) – created by <a class="reference internal" href="#Document.make_bookmark" title="Document.make_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.make_bookmark()</span></code></a>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the new (chapter, pno) of the page.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.chapter_page_count">
<code class="sig-name descname">chapter_page_count</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chapter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.chapter_page_count" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v.1.17.0)</em> Return the number of pages of a chapter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chapter</strong> (<em>int</em>) – the 0-based chapter number.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of pages in chapter. Relevant only for document types whith chapter support (EPUB currently).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.next_location">
<code class="sig-name descname">next_location</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">page_id</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.next_location" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v.1.17.0)</em> Return the location of the following page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>page_id</strong> (<em>tuple</em>) – the current page id. This must be a tuple <em>(chapter, pno)</em> identifying an existing page.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tuple of the following page, i.e. either <em>(chapter, pno + 1)</em> or <em>(chapter + 1, 0)</em>, <strong>or</strong> the empty tuple <em>()</em> if the argument was the last page. Relevant only for document types whith chapter support (EPUB currently).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.prev_location">
<code class="sig-name descname">prev_location</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">page_id</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.prev_location" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v.1.17.0)</em> Return the locator of the preceeding page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>page_id</strong> (<em>tuple</em>) – the current page id. This must be a tuple <em>(chapter, pno)</em> identifying an existing page.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tuple of the preceeding page, i.e. either <em>(chapter, pno - 1)</em> or the last page of the receeding chapter, <strong>or</strong> the empty tuple <em>()</em> if the argument was the first page. Relevant only for document types whith chapter support (EPUB currently).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.load_page">
<code class="sig-name descname">load_page</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">page_id</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.load_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> object for further processing (like rendering, text searching, etc.).</p>
<p><em>(Changed in v1.17.0)</em> For document types supporting a so-called “chapter structure” (like EPUB), pages can also be loaded via the combination of chapter number and relative page number, instead of the absolute page number. This should <strong>significantly speed up access</strong> for large documents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>page_id</strong> (<em>int</em><em>,</em><em>tuple</em>) – <p><em>(Changed in v1.17.0)</em></p>
<p>Either a 0-based page number, or a tuple <em>(chapter, pno)</em>. For an <strong>integer</strong>, any <em>-inf &lt; page_id &lt; page_count</em> is acceptable. While page_id is negative, <a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">page_count</span></code></a> will be added to it. For example: to load the last page, you can use <em>doc.load_page(-1)</em>. After this you have page.number = doc.page_count - 1.</p>
<p>For a tuple, <em>chapter</em> must be in range <a class="reference internal" href="#Document.chapter_count" title="Document.chapter_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a>, and <em>pno</em> must be in range <a class="reference internal" href="#Document.chapter_page_count" title="Document.chapter_page_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.chapter_page_count()</span></code></a> of that chapter. Both values are 0-based. Using this notation, <a class="reference internal" href="page.html#Page.number" title="Page.number"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.number</span></code></a> will equal the given tuple. Relevant only for document types whith chapter support (EPUB currently).</p>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Documents also follow the Python sequence protocol with page numbers as indices: <em>doc.load_page(n) == doc[n]</em>.</p>
<p>For <strong>absolute page numbers</strong> only, expressions like <em>“for page in doc: …”</em> and <em>“for page in reversed(doc): …”</em> will successively yield the document’s pages. Refer to <a class="reference internal" href="#Document.pages" title="Document.pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pages()</span></code></a> which allows processing pages as with slicing.</p>
<p>You can also use index notation with the new chapter-based page identification: use <em>page = doc[(5, 2)]</em> to load the third page of the sixth chapter.</p>
<p>To maintain a consistent API, for document types not supporting a chapter structure (like PDFs), <a class="reference internal" href="#Document.chapter_count" title="Document.chapter_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a> is 1, and pages can also be loaded via tuples <em>(0, pno)</em>. See this <a class="footnote-reference brackets" href="#f3" id="id3">3</a> footnote for comments on performance improvements.</p>
</div>
<dl class="py method">
<dt id="Document.reload_page">
<code class="sig-name descname">reload_page</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">page</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.reload_page" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.10)</em></p>
<p>PDF only: Provide a new copy of a page after finishing and updating all pending changes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>page</strong> (<a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>) – page object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new copy of the same page. All pending updates (e.g. to annotations or widgets) will be finalized and a fresh copy of the page will be loaded.
.. note:: In a typical use case, a page <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> should be taken after annotations / widgets have been added or changed. To force all those changes being reflected in the page structure, this method re-instates a fresh copy while keeping the object hierarchy “document -&gt; page -&gt; annotation(s)” intact.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.page_cropbox">
<code class="sig-name descname">page_cropbox</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.page_cropbox" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.17.7)</em></p>
<p>PDF only: Return the unrotated page rectangle – <a href="#id4"><span class="problematic" id="id5">**</span></a>without reading the page (via <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a>). This is meant for internal purpose requiring best possible performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 0-based page number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> of the page like <a class="reference internal" href="page.html#Page.rect" title="Page.rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.rect()</span></code></a>, but ignoring any rotation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.page_xref">
<code class="sig-name descname">page_xref</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.page_xref" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.17.7)</em></p>
<p>PDF only: Return the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the page – <a href="#id6"><span class="problematic" id="id7">**</span></a>without reading the page (via <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a>). This is meant for internal purpose requiring best possible performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 0-based page number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the page like <a class="reference internal" href="page.html#Page.xref" title="Page.xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.xref</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.pages">
<code class="sig-name descname">pages</code><span class="sig-paren">(</span><em class="sig-param">start=None</em><span class="optional">[</span>, <em class="sig-param">stop=None</em><span class="optional">[</span>, <em class="sig-param">step=None</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.pages" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.4)</em></p>
<p>A generator for a given range of pages. Parameters have the same meaning as in the built-in function <em>range()</em>. Intended for expressions of the form <em>“for page in doc.pages(start, stop, step): …”</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>int</em>) – start iteration with this page number. Default is zero, allowed values are -inf &lt; start &lt; page_count. While this is negative, <a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">page_count</span></code></a> is added <strong>before</strong> starting the iteration.</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – stop iteration at this page number. Default is <a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">page_count</span></code></a>, possible are -inf &lt; stop &lt;= page_count. Larger values are <strong>silently replaced</strong> by the default. Negative values will cyclically emit the pages in reversed order. As with the built-in <em>range()</em>, this is the first page <strong>not</strong> returned.</p></li>
<li><p><strong>step</strong> (<em>int</em>) – stepping value. Defaults are 1 if start &lt; stop and -1 if start &gt; stop. Zero is not allowed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a generator iterator over the document’s pages. Some examples:</p>
<ul class="simple">
<li><p>”doc.pages()” emits all pages.</p></li>
<li><p>”doc.pages(4, 9, 2)” emits pages 4, 6, 8.</p></li>
<li><p>”doc.pages(0, None, 2)” emits all pages with even numbers.</p></li>
<li><p>”doc.pages(-2)” emits the last two pages.</p></li>
<li><p>”doc.pages(-1, -1)” emits all pages in reversed order.</p></li>
<li><p>”doc.pages(-1, -10)” emits pages in reversed order, starting with the last page <strong>repeatedly</strong>. For a 4-page document the following page numbers are emitted: 3, 2, 1, 0, 3, 2, 1, 0, 3, 2, 1, 0, 3.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-1"></span><dl class="py method">
<dt id="Document.convert_to_pdf">
<code class="sig-name descname">convert_to_pdf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_page</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">to_page</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">rotate</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.convert_to_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a PDF version of the current document and write it to memory. <strong>All document types</strong> are supported. The parameters have the same meaning as in <a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code></a>. In essence, you can restrict the conversion to a page subset, specify page rotation, and revert page sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_page</strong> (<em>int</em>) – first page to copy (0-based). Default is first page.</p></li>
<li><p><strong>to_page</strong> (<em>int</em>) – last page to copy (0-based). Default is last page.</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – rotation angle. Default is 0 (no rotation). Should be <em>n * 90</em> with an integer n (not checked).</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytes</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>a Python <em>bytes</em> object containing a PDF file image. It is created by internally using <code class="docutils literal notranslate"><span class="pre">tobytes(garbage=4,</span> <span class="pre">deflate=True)</span></code>. See <a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tobytes()</span></code></a>. You can output it directly to disk or open it as a PDF. Here are some examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># convert an XPS file to PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xps</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfbytes</span> <span class="o">=</span> <span class="n">xps</span><span class="o">.</span><span class="n">convert_to_pdf</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># either do this ---&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">pdfbytes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;some.pdf&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or this ---&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;some.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfout</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="n">pdfbytes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># copy image files to PDF pages</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># each page will have image dimensions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>                     <span class="c1"># new PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imglist</span> <span class="o">=</span> <span class="p">[</span> <span class="o">...</span> <span class="n">image</span> <span class="n">file</span> <span class="n">names</span> <span class="o">...</span><span class="p">]</span> <span class="c1"># e.g. a directory listing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">imglist</span><span class="p">:</span>
<span class="go">        imgdoc=fitz.open(img)           # open image as a document</span>
<span class="go">        pdfbytes=imgdoc.convert_to_pdf()  # make a 1-page PDF of it</span>
<span class="go">        imgpdf=fitz.open(&quot;pdf&quot;, pdfbytes)</span>
<span class="go">        doc.insert_pdf(imgpdf)             # insert the image PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;allmyimages.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method uses the same logic as the <em>mutool convert</em> CLI. This works very well in most cases – however, beware of the following limitations.</p>
<ul class="simple">
<li><p>Image files: perfect, no issues detected. Apparently however, image transparency is ignored. If you need that (like for a watermark), use <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> instead. Otherwise, this method is recommended for its much better prformance.</p></li>
<li><p>XPS: appearance very good. Links work fine, outlines (bookmarks) are lost, but can easily be recovered <a class="footnote-reference brackets" href="#f2" id="id8">2</a>.</p></li>
<li><p>EPUB, CBZ, FB2: similar to XPS.</p></li>
<li><p>SVG: medium. Roughly comparable to <a class="reference external" href="https://github.com/deeplook/svglib">svglib</a>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.get_toc">
<code class="sig-name descname">get_toc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">simple</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_toc" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a table of contents (TOC) out of the document’s outline chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>simple</strong> (<em>bool</em>) – Indicates whether a simple or a detailed TOC is required. If <em>False</em>, each item of the list also contains a dictionary with <a class="reference internal" href="linkdest.html#linkdest"><span class="std std-ref">linkDest</span></a> details for each outline entry.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>a list of lists. Each entry has the form <em>[lvl, title, page, dest]</em>. Its entries have the following meanings:</p>
<ul class="simple">
<li><p><em>lvl</em> – hierarchy level (positive <em>int</em>). The first entry is always 1. Entries in a row are either <strong>equal</strong>, <strong>increase</strong> by 1, or <strong>decrease</strong> by any number.</p></li>
<li><p><em>title</em> – title (<em>str</em>)</p></li>
<li><p><em>page</em> – 1-based page number (<em>int</em>). If <cite>-1</cite> either no destination or outside document.</p></li>
<li><p><em>dest</em> – (<em>dict</em>) included only if <em>simple=False</em>. Contains details of the TOC item as follows:</p>
<ul>
<li><p>kind: destination kind, see <a class="reference internal" href="vars.html#linkdest-kinds"><span class="std std-ref">Link Destination Kinds</span></a>.</p></li>
<li><p>file: filename if kind is <a class="reference internal" href="vars.html#LINK_GOTOR" title="LINK_GOTOR"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTOR</span></code></a> or <a class="reference internal" href="vars.html#LINK_LAUNCH" title="LINK_LAUNCH"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_LAUNCH</span></code></a>.</p></li>
<li><p>page: target page, 0-based, <a class="reference internal" href="vars.html#LINK_GOTOR" title="LINK_GOTOR"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTOR</span></code></a> or <a class="reference internal" href="vars.html#LINK_GOTO" title="LINK_GOTO"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTO</span></code></a> only.</p></li>
<li><p>to: position on target page (<a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a>).</p></li>
<li><p>zoom: (float) zoom factor on target page.</p></li>
<li><p>xref: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the item (0 if no PDF).</p></li>
<li><p>color: item color in PDF RGB format <code class="docutils literal notranslate"><span class="pre">(red,</span> <span class="pre">green,</span> <span class="pre">blue)</span></code>, or omitted (always omitted if no PDF).</p></li>
<li><p>bold: true if bold item text or omitted. PDF only.</p></li>
<li><p>italic: true if italic item text, or omitted. PDF only.</p></li>
<li><p>collapse: true if sub-items are folded, or omitted. PDF only.</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.xref_get_keys">
<code class="sig-name descname">xref_get_keys</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_get_keys" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v 1.18.7)</em></p>
<p>PDF only: Return the PDF dictionary keys of the object provided by its xref number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a tuple of dictionary keys present in object <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fitz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xref</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">page_xref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># xref of page 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="n">xref</span><span class="p">))</span>
<span class="go">(&#39;Type&#39;, &#39;Contents&#39;, &#39;Resources&#39;, &#39;MediaBox&#39;, &#39;Parent&#39;)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.xref_get_key">
<code class="sig-name descname">xref_get_key</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em>, <em class="sig-param"><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_get_key" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v 1.18.7)</em></p>
<p>PDF only: Return type and value of a PDF dictionary key of an xref.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – the desired PDF key. Must <strong>exactly</strong> match (case-sensitive) one of the keys contained in <a class="reference internal" href="#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a tuple (type, value), where type is one of “xref”, “array”, “dict”, “int”, “float” “null”, “bool”, “float”, “name”, “string” or “unknown” (should not occur). Independent of “type”, the value of the key is <strong>always</strong> formatted as a string – see the following example – and a faithful reflection of what is stored in the PDF. An argument like the return value can be used to modify the value of a key of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="n">xref</span><span class="p">):</span>
<span class="go">        print(key, &quot;=&quot; , doc.xref_get_key(xref, key))</span>
<span class="go">Type = [&#39;name&#39;, &#39;/Page&#39;]</span>
<span class="go">Contents = [&#39;xref&#39;, &#39;1297 0 R&#39;]</span>
<span class="go">Resources = [&#39;xref&#39;, &#39;1296 0 R&#39;]</span>
<span class="go">MediaBox = [&#39;array&#39;, &#39;[0 0 612 792]&#39;]</span>
<span class="go">Parent = [&#39;xref&#39;, &#39;1301 0 R&#39;]</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.xref_set_key">
<code class="sig-name descname">xref_set_key</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em>, <em class="sig-param"><span class="n">key</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_set_key" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v 1.18.7)</em></p>
<p>PDF only: Set the value of a PDF key in the object given by an xref. This is an expert function: if you do not know what you are doing, there is a high risk to render (parts of) the PDF unusable. Please do consult <a class="reference internal" href="app4.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> about object specification formats (page 51) and the structure of special dictionary types like page objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – the desired PDF key (without leading “/”). Must not be empty. Any valid PDF key – whether already present in the object (which will be overwritten) – or new. It is possible to use PDF path notation like <code class="docutils literal notranslate"><span class="pre">&quot;Resources/ExtGState&quot;</span></code> – which sets the value for key <code class="docutils literal notranslate"><span class="pre">&quot;/ExtGState&quot;</span></code> as a sub-object of <code class="docutils literal notranslate"><span class="pre">&quot;/Resources&quot;</span></code>.</p></li>
<li><p><strong>value</strong> (<em>str</em>) – <p>the value for the key. It must be a non-empty string and, depending on the desired PDF object type, the following rules must be observed – there is some syntax, but no type checking and no checking of the PDF semantics. Upper or lower case are important!</p>
<ul>
<li><p><strong>xref</strong> – must be provided as <code class="docutils literal notranslate"><span class="pre">&quot;nnn</span> <span class="pre">0</span> <span class="pre">R&quot;</span></code> with a valid <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number nnn of the PDF. The suffix “<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">R</span></code>” is required to be recognizable as a xref.</p></li>
<li><p><strong>array</strong> – a string like <code class="docutils literal notranslate"><span class="pre">&quot;[a</span> <span class="pre">b</span> <span class="pre">c</span> <span class="pre">d</span> <span class="pre">e</span> <span class="pre">f</span> <span class="pre">...]&quot;</span></code>. The brackets are required. Array items must be separated by at least one space (not commas like in Python). An empty array <code class="docutils literal notranslate"><span class="pre">&quot;[]&quot;</span></code> is possible and equivalent to removing the key. Array items may be any PDF objects, like dictionaries, xrefs, other arrays, etc. Like in Python, array items need not be of the same type.</p></li>
<li><p><strong>dict</strong> – a string like <code class="docutils literal notranslate"><span class="pre">&quot;&lt;&lt;</span> <span class="pre">...</span> <span class="pre">&gt;&gt;&quot;</span></code>. The brackets are required and must enclose a valid PDF dictionary definition. The empty dictionary <code class="docutils literal notranslate"><span class="pre">&quot;&lt;&lt;&gt;&gt;&quot;</span></code> is possible and equivalent to removing the key.</p></li>
<li><p><strong>int</strong> – an integer formatted <strong>as a string</strong>.</p></li>
<li><p><strong>float</strong> – a float formatted <strong>as a string</strong>. Scientific notation (with exponents) is not allowed by PDF.</p></li>
<li><p><strong>null</strong> – the string <code class="docutils literal notranslate"><span class="pre">&quot;null&quot;</span></code>. This is the PDF equivalent to Python’s <code class="docutils literal notranslate"><span class="pre">None</span></code> and causes the key to be ignored – however not necessarily removed.</p></li>
<li><p><strong>bool</strong> – one of the strings <code class="docutils literal notranslate"><span class="pre">&quot;true&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;false&quot;</span></code>.</p></li>
<li><p><strong>name</strong> – a valid PDF name with a leading slash: <code class="docutils literal notranslate"><span class="pre">&quot;/PageLayout&quot;</span></code>.</p></li>
<li><p><strong>string</strong> – a valid PDF string. Denote the empty string as <code class="docutils literal notranslate"><span class="pre">&quot;()&quot;</span></code>. Depending on its content, it must be enclosed in bracket types “(…)” or “&lt;…&gt;”, and reserved PDF characters must be escaped. If in doubt, we <strong>strongly recommend</strong> to use <a class="reference internal" href="functions.html#getPDFstr" title="getPDFstr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getPDFstr()</span></code></a>! This function automatically determines the required format. E.g. it will do conversions like <code class="docutils literal notranslate"><span class="pre">fitz.getPDFstr(&quot;Pay</span> <span class="pre">in</span> <span class="pre">$</span> <span class="pre">or</span> <span class="pre">€.&quot;)</span> <span class="pre">=</span> <span class="pre">&quot;&lt;feff00500061007900200069006e002000240020006f0072002020ac002e&gt;&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">fitz.getPDFstr(&quot;Prices</span> <span class="pre">in</span> <span class="pre">USD</span> <span class="pre">(EUR</span> <span class="pre">accepted).&quot;)</span> <span class="pre">=</span> <span class="pre">&quot;(Prices</span> <span class="pre">in</span> <span class="pre">USD</span> <span class="pre">\(EUR</span> <span class="pre">accepted\).)&quot;</span></code>.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.get_page_pixmap">
<code class="sig-name descname">get_page_pixmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_pixmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a pixmap from page <em>pno</em> (zero-based). Invokes <a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – page number, 0-based in -inf &lt; pno &lt; page_count.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.get_page_xobjects">
<code class="sig-name descname">get_page_xobjects</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_xobjects" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: <em>(New in v1.16.13)</em> Return a list of all XObjects referenced by a page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – page number, 0-based, <em>-inf &lt; pno &lt; page_count</em>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>a list of (non-image) XObjects. These objects typically represent pages <em>embedded</em> (not copied) from other PDFs. For example, <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> will create this type of object. An item of this list has the following layout: <strong>(xref, name, invoker, bbox)</strong>, where</p>
<ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) is the XObject’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></li>
<li><p><strong>name</strong> (<em>str</em>) is the symbolic name to reference the XObject</p></li>
<li><p><strong>invoker</strong> (<em>int</em>) the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the invoking XObject or zero if the page directly invokes it</p></li>
<li><p><strong>bbox</strong> (<em>tuple</em>) the boundary box of the XObject’s location on the page <strong>in untransformed coordinates</strong>. To get actual, non-rotated page coordinates, multiply with the page’s transformation matrix <a class="reference internal" href="page.html#Page.transformation_matrix" title="Page.transformation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.transformation_matrix</span></code></a>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.get_page_images">
<code class="sig-name descname">get_page_images</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em>, <em class="sig-param"><span class="n">full</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_images" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Return a list of all images (directly or indirectly) referenced by the page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – page number, 0-based, <em>-inf &lt; pno &lt; page_count</em>.</p></li>
<li><p><strong>full</strong> (<em>bool</em>) – whether to also include the referencer’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> (which is zero if this is the page).</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of images shown on this page. Each item looks like</p>
</dd>
</dl>
<p><strong>(xref, smask, width, height, bpc, colorspace, alt. colorspace, name, filter, referencer)</strong></p>
<p>Where</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) is the image object number</p></li>
<li><p><strong>smask</strong> (<em>int</em>) is the object number of its soft-mask image</p></li>
<li><p><strong>width</strong> and <strong>height</strong> (<em>ints</em>) are the image dimensions</p></li>
<li><p><strong>bpc</strong> (<em>int</em>) denotes the number of bits per component (normally 8)</p></li>
<li><p><strong>colorspace</strong> (<em>str</em>) a string naming the colorspace (like <strong>DeviceRGB</strong>)</p></li>
<li><p><strong>alt. colorspace</strong> (<em>str</em>) is any alternate colorspace depending on the value of <strong>colorspace</strong></p></li>
<li><p><strong>name</strong> (<em>str</em>) is the symbolic name by which the image is referenced</p></li>
<li><p><strong>filter</strong> (<em>str</em>) is the decode filter of the image (<a class="reference internal" href="app4.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>, pp. 65).</p></li>
<li><p><strong>referencer</strong> (<em>int</em>) the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the referencer. Zero if directly referenced by the page. Only present if <em>full=True</em>.</p></li>
</ul>
</div></blockquote>
<p>See below how this information can be used to extract PDF images as separate files. Another demonstration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">get_page_images</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[[316, 0, 261, 115, 8, &#39;DeviceRGB&#39;, &#39;&#39;, &#39;Im1&#39;, &#39;DCTDecode&#39;, 0]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pix</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">316</span><span class="p">)</span>  <span class="c1"># 316 is the xref of the image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pix</span>
<span class="go">fitz.Pixmap(DeviceRGB, fitz.IRect(0, 0, 261, 115), 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.get_page_fonts">
<code class="sig-name descname">get_page_fonts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em>, <em class="sig-param"><span class="n">full</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_fonts" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Return a list of all fonts (directly or indirectly) referenced by the page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – page number, 0-based, -inf &lt; pno &lt; page_count.</p></li>
<li><p><strong>full</strong> (<em>bool</em>) – whether to also include the referencer’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. If <em>True</em>, the returned items are one entry longer. Use this option if you need to know, whether the page directly references the font. In this case the last entry is 0. If the font is referenced by an <code class="docutils literal notranslate"><span class="pre">/XObject</span></code> of the page, you will find its <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> here.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of fonts referenced by this page. Each entry looks like</p>
</dd>
</dl>
<p><strong>(xref, ext, type, basefont, name, encoding, referencer)</strong>,</p>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) is the font object number (may be zero if the PDF uses one of the builtin fonts directly)</p></li>
<li><p><strong>ext</strong> (<em>str</em>) font file extension (e.g. “ttf”, see <a class="reference internal" href="vars.html#fontextensions"><span class="std std-ref">Font File Extensions</span></a>)</p></li>
<li><p><strong>type</strong> (<em>str</em>) is the font type (like “Type1” or “TrueType” etc.)</p></li>
<li><p><strong>basefont</strong> (<em>str</em>) is the base font name,</p></li>
<li><p><strong>name</strong> (<em>str</em>) is the symbolic name, by which the font is referenced</p></li>
<li><p><strong>encoding</strong> (<em>str</em>) the font’s character encoding if different from its built-in encoding (<a class="reference internal" href="app4.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>, p. 414):</p></li>
<li><p><strong>referencer</strong> (<em>int</em> optional) the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the referencer. Zero if directly referenced by the page, otherwise the xref of an XObject. Only present if <em>full=True</em>.</p></li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_page_fonts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">[(12, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;FNUUTH+Calibri-Bold&#39;, &#39;R8&#39;, &#39;&#39;),</span>
<span class="go"> (13, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;DOKBTG+Calibri&#39;, &#39;R10&#39;, &#39;&#39;),</span>
<span class="go"> (14, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;NOHSJV+Calibri-Light&#39;, &#39;R12&#39;, &#39;&#39;),</span>
<span class="go"> (15, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;NZNDCL+CourierNewPSMT&#39;, &#39;R14&#39;, &#39;&#39;),</span>
<span class="go"> (16, &#39;ttf&#39;, &#39;Type0&#39;, &#39;MNCSJY+SymbolMT&#39;, &#39;R17&#39;, &#39;Identity-H&#39;),</span>
<span class="go"> (17, &#39;cff&#39;, &#39;Type1&#39;, &#39;UAEUYH+Helvetica&#39;, &#39;R20&#39;, &#39;WinAnsiEncoding&#39;),</span>
<span class="go"> (18, &#39;ttf&#39;, &#39;Type0&#39;, &#39;ECPLRU+Calibri&#39;, &#39;R23&#39;, &#39;Identity-H&#39;),</span>
<span class="go"> (19, &#39;ttf&#39;, &#39;Type0&#39;, &#39;TONAYT+CourierNewPSMT&#39;, &#39;R27&#39;, &#39;Identity-H&#39;)]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This list has no duplicate entries: the combination of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>, <em>name</em> and <em>referencer</em> is unique.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.get_page_text">
<code class="sig-name descname">get_page_text</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em>, <em class="sig-param"><span class="n">output</span><span class="o">=</span><span class="default_value">'text'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the text of a page given its page number <em>pno</em> (zero-based). Invokes <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – page number, 0-based, any value <em>-inf &lt; pno &lt; page_count</em>.</p></li>
<li><p><strong>output</strong> (<em>str</em>) – A string specifying the requested output format: text, html, json or xml. Default is <em>text</em>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-2"></span><dl class="py method">
<dt id="Document.layout">
<code class="sig-name descname">layout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rect</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">height</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">11</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-paginate (“reflow”) the document based on the given page dimension and fontsize. This only affects some document types like e-books and HTML. Ignored if not supported. Supported documents have <em>True</em> in property <a class="reference internal" href="#Document.is_reflowable" title="Document.is_reflowable"><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_reflowable</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – desired page size. Must be finite, not empty and start at point (0, 0).</p></li>
<li><p><strong>width</strong> (<em>float</em>) – use it together with <em>height</em> as alternative to <em>rect</em>.</p></li>
<li><p><strong>height</strong> (<em>float</em>) – use it together with <em>width</em> as alternative to <em>rect</em>.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – the desired default fontsize.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.select">
<code class="sig-name descname">select</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.select" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Keeps only those pages of the document whose numbers occur in the list. Empty sequences or elements outside <em>range(len(doc))</em> will cause a <em>ValueError</em>. For more details see remarks at the bottom or this chapter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>s</strong> (<em>sequence</em>) – The sequence (see <a class="reference internal" href="app4.html#sequencetypes"><span class="std std-ref">Using Python Sequences as Arguments in PyMuPDF</span></a>) of page numbers (zero-based) to be included. Pages not in the sequence will be deleted (from memory) and become unavailable until the document is reopened. <strong>Page numbers can occur multiple times and in any order:</strong> the resulting document will reflect the sequence exactly as specified.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Page numbers in the sequence need not be unique nor be in any particular order. This makes the method a versatile utility to e.g. select only the even or the odd pages or meeting some other criteria and so forth.</p></li>
<li><p>On a technical level, the method will always create a new <a class="reference internal" href="glossary.html#pagetree" title="pagetree"><code class="xref py py-data docutils literal notranslate"><span class="pre">pagetree</span></code></a>.</p></li>
<li><p>When dealing with only a few pages, methods <a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code></a>, <a class="reference internal" href="#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">move_page()</span></code></a>, <a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code></a> are easier to use. In fact, they are also <strong>much faster</strong> – by at least one order of magnitude when the document has many pages.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.set_metadata">
<code class="sig-name descname">set_metadata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Sets or updates the metadata of the document as specified in <em>m</em>, a Python dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>m</strong> (<em>dict</em>) – A dictionary with the same keys as <em>metadata</em> (see below). All keys are optional. A PDF’s format and encryption method cannot be set or changed and will be ignored. If any value should not contain data, do not specify its key or set the value to <em>None</em>. If you use <em>{}</em> all metadata information will be cleared to the string <em>“none”</em>. If you want to selectively change only some values, modify a copy of <em>doc.metadata</em> and use it as the argument. Arbitrary unicode values are possible if specified as UTF-8-encoded.</p>
</dd>
</dl>
<p><em>(Changed in v1.18.4)</em> Empty values or “none” are no longer written, but completely omitted.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.get_xml_metadata">
<code class="sig-name descname">get_xml_metadata</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_xml_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Get the document XML metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>XML metadata of the document. Empty string if not present or not a PDF.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.set_xml_metadata">
<code class="sig-name descname">set_xml_metadata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xml</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_xml_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Sets or updates XML metadata of the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xml</strong> (<em>str</em>) – the new XML metadata. Should be XML syntax, however no checking is done by this method and any string is accepted.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.set_toc">
<code class="sig-name descname">set_toc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">toc</span></em>, <em class="sig-param"><span class="n">collapse</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_toc" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Replaces the <strong>complete current outline</strong> tree (table of contents) with the one provided as the argument. After successful execution, the new outline tree can be accessed as usual via <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> or via <a class="reference internal" href="#Document.outline" title="Document.outline"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.outline</span></code></a>. Like with other output-oriented methods, changes become permanent only via <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> (incremental save supported). Internally, this method consists of the following two steps. For a demonstration see example below.</p>
<ul class="simple">
<li><p>Step 1 deletes all existing bookmarks.</p></li>
<li><p>Step 2 creates a new TOC from the entries contained in <em>toc</em>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>toc</strong> (<em>sequence</em>) – <p>A list / tuple with <strong>all bookmark entries</strong> that should form the new table of contents. Output variants of <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_toc()</span></code></a> are acceptable. To completely remove the table of contents specify an empty sequence or None. Each item must be a list with the following format.</p>
<ul>
<li><p>[lvl, title, page [, dest]] where</p>
<ul>
<li><p><strong>lvl</strong> is the hierarchy level (int &gt; 0) of the item, which <strong>must be 1</strong> for the first item and at most 1 larger than the previous one.</p></li>
<li><p><strong>title</strong> (str) is the title to be displayed. It is assumed to be UTF-8-encoded (relevant for multibyte code points only).</p></li>
<li><p><strong>page</strong> (int) is the target page number <strong>(attention: 1-based)</strong>. Must be in valid range if positive. Set it to -1 if there is no target, or the target is external.</p></li>
<li><p><strong>dest</strong> (optional) is a dictionary or a number. If a number, it will be interpreted as the desired height (in points) this entry should point to on the page. Use a dictionary (like the one given as output by <code class="docutils literal notranslate"><span class="pre">get_toc(False)</span></code>) for a detailed control of the bookmark’s properties, see <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> for a description.</p></li>
</ul>
</li>
</ul>
</p></li>
<li><p><strong>collapse</strong> (<em>int</em>) – <em>(new in version 1.16.9)</em> controls the hierarchy level beyond which outline entries should initially show up collapsed. The default 1 will hence only display level 1, higher levels must be unfolded using the PDF viewer. To unfold everything, specify either a large integer, 0 or None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of inserted, resp. deleted items.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.outline_xref">
<code class="sig-name descname">outline_xref</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.outline_xref" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.17.7)</em></p>
<p>PDF only: Return the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the outline item. This is mainly used for internal purposes.</p>
<p>arg int idx: index of the item in list <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.del_toc_item">
<code class="sig-name descname">del_toc_item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.del_toc_item" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.17.7)</em></p>
<p>PDF only: Remove this TOC item. This is a high-speed method primarily meant for <em>disabling</em> items, which are pointing to deleted pages. Physically, the item still exists in the TOC tree, but will show an empty title and no longer point to a destination. So the overall TOC structure remains intact.</p>
<p>This also implies that you can reassign the item to a destination when required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – the index of the item in list <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.set_toc_item">
<code class="sig-name descname">set_toc_item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span></em>, <em class="sig-param"><span class="n">dest_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pno</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">uri</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">to</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zoom</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_toc_item" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.17.7)</em></p>
<p><em>(Changed in v1.18.6)</em></p>
<p>PDF only: Changes the TOC item identified by its index. Change the item <strong>title</strong>, <strong>destination</strong>, <strong>appearance</strong> (color, bold, italic) or collapsing sub-items – or to remove the item altogether.</p>
<p>Use this method if you need specific changes for selected entries only and want to avoid replacing the complete TOC. This is beneficial especially when dealing with large table of contents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – the index of the entry in the list created by <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a>.</p></li>
<li><p><strong>dest_dict</strong> (<em>dict</em>) – the new destination. A dictionary like the last entry of an item in <code class="docutils literal notranslate"><span class="pre">doc.get_toc(False)</span></code>. Using this as a template is recommended. When given, <strong>all other parameters are ignored</strong> – except title.</p></li>
<li><p><strong>kind</strong> (<em>int</em>) – the link kind, see <a class="reference internal" href="vars.html#linkdest-kinds"><span class="std std-ref">Link Destination Kinds</span></a>. If <a class="reference internal" href="vars.html#LINK_NONE" title="LINK_NONE"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_NONE</span></code></a>, then all remaining parameter will be ignored, and the TOC item will be removed – same as <a class="reference internal" href="#Document.del_toc_item" title="Document.del_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a>. If None, then only the title is modified and the remaining parameters are ignored. All other values will lead to making a new destination dictionary using the subsequent arguments.</p></li>
<li><p><strong>pno</strong> (<em>int</em>) – the 1-based page number, i.e. a value 1 &lt;= pno &lt;= doc.page_count. Required for LINK_GOTO.</p></li>
<li><p><strong>uri</strong> (<em>str</em>) – the URL text. Required for LINK_URI.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – the desired new title. None if no change.</p></li>
<li><p><strong>to</strong> (<em>point_like</em>) – (optional) points to a coordinate on the arget page. Relevant for LINK_GOTO. If omitted, a point near the page’s top is chosen.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – required for LINK_GOTOR and LINK_LAUNCH.</p></li>
<li><p><strong>zoom</strong> (<em>float</em>) – use this zoom factor when showing the target page.</p></li>
</ul>
</dd>
</dl>
<p><strong>Example use:</strong> Change the TOC of the SWIG manual to achieve this:</p>
<p>Collapse everything below top level and show the chapter on Python support in red, bold and italic:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fitz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;SWIGDocumentation.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># we need the detailed TOC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># make a list of level 1 indices and their titles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lvl1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">toc</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">lvl1</span><span class="p">:</span>
<span class="go">        d = toc[i][3]  # get the destination dict</span>
<span class="go">        d[&quot;collapse&quot;] = True  # collapse items underneath</span>
<span class="go">        if &quot;Python&quot; in title:  # show the &#39;Python&#39; chapter</span>
<span class="go">            d[&quot;color&quot;] = (1, 0, 0)  # in red,</span>
<span class="go">            d[&quot;bold&quot;] = True  # bold and</span>
<span class="go">            d[&quot;italic&quot;] = True  # italic</span>
<span class="go">        doc.set_toc_item(i, dest_dict=d)  # update this toc item</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;NEWSWIG.pdf&quot;</span><span class="p">,</span><span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>In the previous example, we have changed only 42 of the 1240 TOC items of the file.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.can_save_incrementally">
<code class="sig-name descname">can_save_incrementally</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.can_save_incrementally" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.0)</em></p>
<p>Check whether the document can be saved incrementally. Use it to choose the right option without encountering exceptions.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.scrub">
<code class="sig-name descname">scrub</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">attached_files</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">clean_pages</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">embedded_files</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">hidden_text</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">javascript</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">redactions</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">redact_images</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">remove_links</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reset_fields</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reset_responses</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">thumbnails</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">xml_metadata</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.scrub" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: <em>(New in v1.16.14)</em> Remove potentially sensitive data from the PDF. This function is inspired by the similar “Sanitize” function in Adobe Acrobat products. The process is configurable by a number of options, which are all <em>True</em> by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attached_files</strong> (<em>bool</em>) – Search for ‘FileAttachment’ annotations and remove the file content.</p></li>
<li><p><strong>clean_pages</strong> (<em>bool</em>) – Remove any comments from page painting sources. If this option is set to <em>False</em>, then this is also done for <em>hidden_text</em> and <em>redactions</em>.</p></li>
<li><p><strong>embedded_files</strong> (<em>bool</em>) – Remove embedded files.</p></li>
<li><p><strong>hidden_text</strong> (<em>bool</em>) – Remove OCR-ed text and invisible text.</p></li>
<li><p><strong>javascript</strong> (<em>bool</em>) – Remove JavaScript sources.</p></li>
<li><p><strong>metadata</strong> (<em>bool</em>) – Remove PDF standard metadata.</p></li>
<li><p><strong>redactions</strong> (<em>bool</em>) – Apply redaction annotations.</p></li>
<li><p><strong>redact_images</strong> (<em>int</em>) – how to handle images if applying redactions. One of 0 (ignore), 1 (blank out overlaps) or 2 (remove).</p></li>
<li><p><strong>remove_links</strong> (<em>bool</em>) – Remove all links.</p></li>
<li><p><strong>reset_fields</strong> (<em>bool</em>) – Reset all form fields to their defaults.</p></li>
<li><p><strong>reset_responses</strong> (<em>bool</em>) – Remove all responses from all annotations.</p></li>
<li><p><strong>thumbnails</strong> (<em>bool</em>) – Remove thumbnail images from pages.</p></li>
<li><p><strong>xml_metadata</strong> (<em>bool</em>) – Remove XML metadata.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outfile</span></em>, <em class="sig-param"><span class="n">garbage</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">clean</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">deflate</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">deflate_images</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">deflate_fonts</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">incremental</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ascii</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">expand</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">linear</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pretty</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">encryption</span><span class="o">=</span><span class="default_value">PDF_ENCRYPT_NONE</span></em>, <em class="sig-param"><span class="n">permissions</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">owner_pw</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">user_pw</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.save" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(Changed in v1.18.7)</em></p>
<p>PDF only: Saves the document in its <strong>current state</strong>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outfile</strong> (<em>str</em><em>,</em><em>Path</em><em>,</em><em>fp</em>) – The file path, <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> or file object to save to. A file object must have been created before via <code class="docutils literal notranslate"><span class="pre">open(...)</span></code> or <code class="docutils literal notranslate"><span class="pre">io.BytesIO()</span></code>. Choosing <code class="docutils literal notranslate"><span class="pre">io.BytesIO()</span></code> is similar to <a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a> below, which equals the <code class="docutils literal notranslate"><span class="pre">getvalue()</span></code> output of an internally created <code class="docutils literal notranslate"><span class="pre">io.BytesIO()</span></code>.</p></li>
<li><p><strong>garbage</strong> (<em>int</em>) – <p>Do garbage collection. Positive values exclude “incremental”.</p>
<ul>
<li><p>0 = none</p></li>
<li><p>1 = remove unused (unreferenced) objects.</p></li>
<li><p>2 = in addition to 1, compact the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> table.</p></li>
<li><p>3 = in addition to 2, merge duplicate objects.</p></li>
<li><p>4 = in addition to 3, check <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a> objects for duplication. This may be slow because such data are typically large.</p></li>
</ul>
</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – Clean and sanitize content streams <a class="footnote-reference brackets" href="#f1" id="id9">1</a>. Corresponds to “mutool clean -sc”.</p></li>
<li><p><strong>deflate</strong> (<em>bool</em>) – Deflate (compress) uncompressed streams.</p></li>
<li><p><strong>deflate_images</strong> (<em>bool</em>) – <em>(new in v1.18.3)</em> Deflate (compress) uncompressed image streams <a class="footnote-reference brackets" href="#f4" id="id10">4</a>.</p></li>
<li><p><strong>deflate_fonts</strong> (<em>bool</em>) – <em>(new in v1.18.3)</em> Deflate (compress) uncompressed fontfile streams <a class="footnote-reference brackets" href="#f4" id="id11">4</a>.</p></li>
<li><p><strong>incremental</strong> (<em>bool</em>) – Only save changes to the PDF. Excludes “garbage” and “linear”. Can only be used if <em>outfile</em> is a string or a <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> and equal to <a class="reference internal" href="#Document.name" title="Document.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.name</span></code></a>. Cannot be used for files that are decrypted or repaired and also in some other cases. To be sure, check <a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a>. If this is false, saving to a new file is required.</p></li>
<li><p><strong>ascii</strong> (<em>bool</em>) – convert binary data to ASCII.</p></li>
<li><p><strong>expand</strong> (<em>int</em>) – <p>Decompress objects. Generates versions that can be better read by some other programs and will lead to larger files.</p>
<ul>
<li><p>0 = none</p></li>
<li><p>1 = images</p></li>
<li><p>2 = fonts</p></li>
<li><p>255 = all</p></li>
</ul>
</p></li>
<li><p><strong>linear</strong> (<em>bool</em>) – Save a linearised version of the document. This option creates a file format for improved performance for Internet access. Excludes “incremental”.</p></li>
<li><p><strong>pretty</strong> (<em>bool</em>) – Prettify the document source for better readability. PDF objects will be reformatted to look like the default output of <a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a>.</p></li>
<li><p><strong>permissions</strong> (<em>int</em>) – <em>(new in version 1.16.0)</em> Set the desired permission levels. See <a class="reference internal" href="vars.html#permissioncodes"><span class="std std-ref">Document Permissions</span></a> for possible values. Default is granting all.</p></li>
<li><p><strong>encryption</strong> (<em>int</em>) – <em>(new in version 1.16.0)</em> set the desired encryption method. See <a class="reference internal" href="vars.html#encryptionmethods"><span class="std std-ref">PDF encryption method codes</span></a> for possible values.</p></li>
<li><p><strong>owner_pw</strong> (<em>str</em>) – <em>(new in version 1.16.0)</em> set the document’s owner password. <em>(Changed in v1.18.3)</em> If not provided, the user password is taken if provided.</p></li>
<li><p><strong>user_pw</strong> (<em>str</em>) – <em>(new in version 1.16.0)</em> set the document’s user password.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.saveIncr">
<code class="sig-name descname">saveIncr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.saveIncr" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: saves the document incrementally. This is a convenience abbreviation for <em>doc.save(doc.name, incremental=True, encryption=PDF_ENCRYPT_KEEP)</em>.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.tobytes">
<code class="sig-name descname">tobytes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">garbage</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">clean</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">deflate</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">deflate_images</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">deflate_fonts</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ascii</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">expand</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">linear</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">pretty</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">encryption</span><span class="o">=</span><span class="default_value">PDF_ENCRYPT_NONE</span></em>, <em class="sig-param"><span class="n">permissions</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">owner_pw</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">user_pw</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.tobytes" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(Changed in v1.18.7)</em></p>
<p>PDF only: Writes the <strong>current content of the document</strong> to a bytes object instead of to a file. Obviously, you should be wary about memory requirements. The meanings of the parameters exactly equal those in <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>. Chapter <a class="reference internal" href="faq.html#faq"><span class="std std-ref">Collection of Recipes</span></a> contains an example for using this method as a pre-processor to <a class="reference external" href="https://pypi.python.org/pypi/pdfrw/0.3">pdfrw</a>.</p>
<p><em>(Changed in version 1.16.0)</em> for extended encryption support.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bytes</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a bytes object containing the complete document.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.search_page_for">
<code class="sig-name descname">search_page_for</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em>, <em class="sig-param"><span class="n">text</span></em>, <em class="sig-param"><span class="n">quads</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.search_page_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for “text” on page number “pno”. Works exactly like the corresponding <a class="reference internal" href="page.html#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a>. Any integer -inf &lt; pno &lt; page_count is acceptable.</p>
</dd></dl>

<span class="target" id="index-3"></span><dl class="py method">
<dt id="Document.insert_pdf">
<code class="sig-name descname">insert_pdf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">docsrc</span></em>, <em class="sig-param"><span class="n">from_page</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">to_page</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">start_at</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">rotate</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">links</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">annots</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">final</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.insert_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Copy the page range <strong>[from_page, to_page]</strong> (including both) of PDF document <em>docsrc</em> into the current one. Inserts will start with page number <em>start_at</em>. Value -1 indicates default values. All pages thus copied will be rotated as specified. Links and annotations can be excluded in the target, see below. All page numbers are 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>docsrc</strong> (<em>Document</em>) – An opened PDF <em>Document</em> which must not be the current document. However, it may refer to the same underlying file.</p></li>
<li><p><strong>from_page</strong> (<em>int</em>) – First page number in <em>docsrc</em>. Default is zero.</p></li>
<li><p><strong>to_page</strong> (<em>int</em>) – Last page number in <em>docsrc</em> to copy. Defaults to last page.</p></li>
<li><p><strong>start_at</strong> (<em>int</em>) – First copied page, will become page number <em>start_at</em> in the target. Default -1 appends the page range to the end. If zero, the page range will be inserted before current first page.</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – All copied pages will be rotated by the provided value (degrees, integer multiple of 90).</p></li>
<li><p><strong>links</strong> (<em>bool</em>) – Choose whether (internal and external) links should be included in the copy. Default is <em>True</em>. Internal links to outside the copied page range are <strong>always excluded</strong>.</p></li>
<li><p><strong>annots</strong> (<em>bool</em>) – <em>(new in version 1.16.1)</em> choose whether annotations should be included in the copy.</p></li>
<li><p><strong>show_progress</strong> (<em>int</em>) – <em>(new in version 1.17.7)</em> specify an interval size greater zero to see progress messages on <code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code>. After each interval, a message like <code class="docutils literal notranslate"><span class="pre">Inserted</span> <span class="pre">30</span> <span class="pre">of</span> <span class="pre">47</span> <span class="pre">pages.</span></code> will be printed.</p></li>
<li><p><strong>final</strong> (<em>int</em>) – <em>(new in v1.18.0)</em> controls whether the list of already copied objects should be <strong>dropped</strong> after this method, default <em>True</em>. Set it to 0 except for the last one of multiple insertions from the same source PDF. This saves target file size and speeds up execution considerably.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>If <em>from_page &gt; to_page</em>, pages will be <strong>copied in reverse order</strong>. If <em>0 &lt;= from_page == to_page</em>, then one page will be copied.</p></li>
<li><p><em>docsrc</em> TOC entries <strong>will not be copied</strong>. It is easy however, to recover a table of contents for the resulting document. Look at the examples below and at program <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/PDFjoiner.py">PDFjoiner.py</a> in the <em>examples</em> directory: it can join PDF documents and at the same time piece together respective parts of the tables of contents.</p></li>
</ol>
</div>
<span class="target" id="index-4"></span><dl class="py method">
<dt id="Document.new_page">
<code class="sig-name descname">new_page</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">595</span></em>, <em class="sig-param"><span class="n">height</span><span class="o">=</span><span class="default_value">842</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.new_page" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Insert an empty page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – page number in front of which the new page should be inserted. Must be in <em>1 &lt; pno &lt;= page_count</em>. Special values -1 and <em>doc.page_count</em> insert <strong>after</strong> the last page.</p></li>
<li><p><strong>width</strong> (<em>float</em>) – page width.</p></li>
<li><p><strong>height</strong> (<em>float</em>) – page height.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the created page object.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-5"></span><dl class="py method">
<dt id="Document.insert_page">
<code class="sig-name descname">insert_page</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em>, <em class="sig-param"><span class="n">text</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">595</span></em>, <em class="sig-param"><span class="n">height</span><span class="o">=</span><span class="default_value">842</span></em>, <em class="sig-param"><span class="n">fontname</span><span class="o">=</span><span class="default_value">'helv'</span></em>, <em class="sig-param"><span class="n">fontfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.insert_page" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Insert a new page and insert some text. Convenience function which combines <a class="reference internal" href="#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a> and (parts of) <a class="reference internal" href="page.html#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – <p>page number (0-based) <strong>in front of which</strong> to insert. Must be in <em>range(-1, len(doc) + 1)</em>. Special values -1 and <em>len(doc)</em> insert <strong>after</strong> the last page.</p>
<dl class="simple">
<dt>Changed in version 1.14.12</dt><dd><p>This is now a positional parameter</p>
</dd>
</dl>
</p>
</dd>
</dl>
<p>For the other parameters, please consult the aforementioned methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the result of <a class="reference internal" href="page.html#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a> (number of successfully inserted lines).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.delete_page">
<code class="sig-name descname">delete_page</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.delete_page" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Delete a page given by its 0-based number in -inf &lt; pno &lt; page_count - 1.</p>
<p>Changed in version 1.14.17</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – the page to be deleted. Negative number count backwards from the end of the document (like with indices). Default is the last page.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.delete_pages">
<code class="sig-name descname">delete_pages</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">from_page</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">to_page</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.delete_pages" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Delete a range of pages given as 0-based numbers. Any <em>-1</em> parameter will first be replaced by <em>doc.page_count - 1</em> (ie. last page number). After that, condition <em>0 &lt;= from_page &lt;= to_page &lt; doc.page_count</em> must be true. If the parameters are equal, this is equivalent to <a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_page</strong> (<em>int</em>) – the first page to be deleted.</p></li>
<li><p><strong>to_page</strong> (<em>int</em>) – the last page to be deleted.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>(Changed in v1.14.17, optimized in v1.17.7)</em> In an effort to maintain a valid PDF structure, this method and <a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code></a> will also invalidate items in the table of contents which happen to point to deleted pages. “Invalidation” here means, that the bookmark will point to nowhere and the title will show the string “&lt;&gt;”. So the overall TOC structure is left intact.</p>
<p>Similarly, it will remove any <strong>links on remaining pages</strong> that point to a deleted page. This action may have an extended response time for documents with many pages.</p>
<p>Example: Delete the page range 500 to 520 from a large PDF, using different methods.</p>
<p>Method 1 - <em>delete_pages</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">fitz</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Adobe PDF Reference 1-7.pdf&quot;</span><span class="p">)</span>
<span class="n">t0</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">();</span><span class="n">doc</span><span class="o">.</span><span class="n">delete_pages</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">520</span><span class="p">);</span><span class="n">t1</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">round</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mf">0.66</span>
</pre></div>
</div>
<p>Method 2 - <em>select</em>, this is more than 10 times <strong>slower</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">521</span><span class="p">,</span> <span class="mi">1310</span><span class="p">))</span>
<span class="n">t0</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">();</span><span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">l</span><span class="p">);</span><span class="n">t1</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">round</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mf">7.62</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.copy_page">
<code class="sig-name descname">copy_page</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em>, <em class="sig-param"><span class="n">to</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.copy_page" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Copy a page reference within the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – the page to be copied. Must be in range <em>0 &lt;= pno &lt; len(doc)</em>.</p></li>
<li><p><strong>to</strong> (<em>int</em>) – the page number in front of which to copy. The default inserts <strong>after</strong> the last page.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only a new <strong>reference</strong> to the page object will be created – not a new page object, all copied pages will have identical attribute values, including the <a class="reference internal" href="page.html#Page.xref" title="Page.xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.xref</span></code></a>. This implies that any changes to one of these copies will appear on all of them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.fullcopy_page">
<code class="sig-name descname">fullcopy_page</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em>, <em class="sig-param"><span class="n">to</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.fullcopy_page" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.14.17)</em></p>
<p>PDF only: Make a full copy (duplicate) of a page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – the page to be duplicated. Must be in range <em>0 &lt;= pno &lt; len(doc)</em>.</p></li>
<li><p><strong>to</strong> (<em>int</em>) – the page number in front of which to copy. The default inserts <strong>after</strong> the last page.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>In contrast to <a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code></a>, this method creates a new page object (with a new <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>), which can be changed independently from the original.</p></li>
<li><p>Any Popup and “IRT” (“in response to”) annotations are <strong>not copied</strong> to avoid potentially incorrect situations.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.move_page">
<code class="sig-name descname">move_page</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pno</span></em>, <em class="sig-param"><span class="n">to</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.move_page" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Move (copy and then delete original) a page within the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – the page to be moved. Must be in range <em>0 &lt;= pno &lt; len(doc)</em>.</p></li>
<li><p><strong>to</strong> (<em>int</em>) – the page number in front of which to insert the moved page. The default moves <strong>after</strong> the last page.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.need_appearances">
<code class="sig-name descname">need_appearances</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.need_appearances" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.17.4)</em></p>
<p>PDF only: Get or set the <em>/NeedAppearances</em> property of Form PDFs. Quote: <em>“(Optional) A flag specifying whether to construct appearance streams and appearance dictionaries for all widget annotations in the document … Default value: false.”</em> This may help controlling the behavior of some readers / viewers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>value</strong> (<em>bool</em>) – set the property to this value. If omitted or <em>None</em>, inquire the current value.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>None: not a Form PDF or property not defined.</p></li>
<li><p>True / False: the value of the property (either just set or existing for inquiries).</p></li>
</ul>
<p>Once set, the property cannot be removed again (which is no problem).</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.get_sigflags">
<code class="sig-name descname">get_sigflags</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_sigflags" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Return whether the document contains signature fields. This is an optional PDF property: if not present (return value -1), no conclusions can be drawn – the PDF creator may just not have bothered to use it.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>-1: not a Form PDF / no signature fields recorded / no <em>SigFlags</em> found.</p></li>
<li><p>1: at least one signature field exists.</p></li>
<li><p>3:  contains signatures that may be invalidated if the file is saved (written) in a way that alters its previous contents, as opposed to an incremental update.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-6"></span><dl class="py method">
<dt id="Document.embfile_add">
<code class="sig-name descname">embfile_add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">buffer</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ufilename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">desc</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_add" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Embed a new file. All string parameters except the name may be unicode (in previous versions, only ASCII worked correctly). File contents will be compressed (where beneficial).</p>
<dl class="simple">
<dt>Changed in version 1.14.16</dt><dd><p>The sequence of positional parameters “name” and “buffer” has been changed to comply with the layout of other functions.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – entry identifier, must not already exist.</p></li>
<li><p><strong>buffer</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – <p>file contents.</p>
<p><em>(Changed in version 1.14.13)</em> <em>io.BytesIO</em> is now also supported.</p>
</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – optional filename. Documentation only, will be set to <em>name</em> if <em>None</em>.</p></li>
<li><p><strong>ufilename</strong> (<em>str</em>) – optional unicode filename. Documentation only, will be set to <em>filename</em> if <em>None</em>.</p></li>
<li><p><strong>desc</strong> (<em>str</em>) – optional description. Documentation only, will be set to <em>name</em> if <em>None</em>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.embfile_count">
<code class="sig-name descname">embfile_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_count" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Return the number of embedded files.</p>
<blockquote>
<div><dl class="simple">
<dt>Changed in version 1.14.16</dt><dd><p>This is now a method. In previous versions, this was a property.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="Document.embfile_get">
<code class="sig-name descname">embfile_get</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_get" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Retrieve the content of embedded file by its entry number or name. If the document is not a PDF, or entry cannot be found, an exception is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item</strong> (<em>int</em><em>,</em><em>str</em>) – index or name of entry. An integer must be in <em>range(embfile_count())</em>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.embfile_del">
<code class="sig-name descname">embfile_del</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_del" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Remove an entry from <cite>/EmbeddedFiles</cite>. As always, physical deletion of the embedded file content (and file space regain) will occur only when the document is saved to a new file with a suitable garbage option.</p>
<blockquote>
<div><dl class="simple">
<dt>Changed in version 1.14.16</dt><dd><p>Items can now be deleted by index, too.</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item</strong> (<em>int/str</em>) – index or name of entry.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When specifying an entry name, this function will only <strong>delete the first item</strong> with that name. Be aware that PDFs not created with PyMuPDF may contain duplicate names. So you may want to take appropriate precautions.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.embfile_info">
<code class="sig-name descname">embfile_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_info" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Retrieve information of an embedded file given by its number or by its name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item</strong> (<em>int/str</em>) – index or name of entry. An integer must be in <em>range(embfile_count())</em>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>a dictionary with the following keys:</p>
<ul class="simple">
<li><p><em>name</em> – (<em>str</em>) name under which this entry is stored</p></li>
<li><p><em>filename</em> – (<em>str</em>) filename</p></li>
<li><p><em>ufilename</em> – (<em>unicode</em>) filename</p></li>
<li><p><em>desc</em> – (<em>str</em>) description</p></li>
<li><p><em>size</em> – (<em>int</em>) original file size</p></li>
<li><p><em>length</em> – (<em>int</em>) compressed file length</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.embfile_names">
<code class="sig-name descname">embfile_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_names" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.14.16)</em></p>
<p>PDF only: Return a list of embedded file names. The sequence of names equals the physical sequence in the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-7"></span><dl class="py method">
<dt id="Document.embfile_upd">
<code class="sig-name descname">embfile_upd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span></em>, <em class="sig-param"><span class="n">buffer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ufilename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">desc</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_upd" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Change an embedded file given its entry number or name. All parameters are optional. Letting them default leads to a no-operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item</strong> (<em>int/str</em>) – index or name of entry. An integer must be in <em>range(0, embfile_count())</em>.</p></li>
<li><p><strong>buffer</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – <p>the new file content.</p>
<p><em>(Changed in version 1.14.13)</em> <em>io.BytesIO</em> is now also supported.</p>
</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – the new filename.</p></li>
<li><p><strong>ufilename</strong> (<em>str</em>) – the new unicode filename.</p></li>
<li><p><strong>desc</strong> (<em>str</em>) – the new description.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.embfile_setinfo">
<code class="sig-name descname">embfile_setinfo</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ufilename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">desc</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_setinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>PDF only: Change embedded file meta information. All parameters are optional. Letting them default will lead to a no-operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em><em>,</em><em>str</em>) – index or name of entry. An integer must be in <em>range(embfile_count())</em>.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – sets the filename.</p></li>
<li><p><strong>ufilename</strong> (<em>str</em>) – sets the unicode filename.</p></li>
<li><p><strong>desc</strong> (<em>str</em>) – sets the description.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Deprecated subset of <a class="reference internal" href="#Document.embfile_upd" title="Document.embfile_upd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">embfile_upd()</span></code></a>. Will be deleted in a future version.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="Document.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Release objects and space allocations associated with the document. If created from a file, also closes <em>filename</em> (releasing control to the OS).</p>
</dd></dl>

<dl class="py method">
<dt id="Document.xref_object">
<code class="sig-name descname">xref_object</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em>, <em class="sig-param"><span class="n">compressed</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ascii</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_object" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.8)</em></p>
<p>PDF only: Return the definition source of a PDF object.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.pdf_catalog">
<code class="sig-name descname">pdf_catalog</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.pdf_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.8)</em></p>
<p>PDF only: Return the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of the PDF catalog (or root) object. Use that number with <a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a> to see its source.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.pdf_trailer">
<code class="sig-name descname">pdf_trailer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compressed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.pdf_trailer" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.8)</em></p>
<p>PDF only: Return the trailer source of the PDF (UTF-8), which is usually located at the PDF file’s end. This is similar to <a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a> except that this object has no identifier to access it.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.xref_xml_metadata">
<code class="sig-name descname">xref_xml_metadata</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_xml_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.8)</em></p>
<p>PDF only: Return the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the document’s XML metadata.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.xref_stream">
<code class="sig-name descname">xref_stream</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_stream" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.8)</em></p>
<p>PDF only: Return the <strong>decompressed</strong> contents of the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> stream object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytes</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the (decompressed) stream of the object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.xref_stream_raw">
<code class="sig-name descname">xref_stream_raw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_stream_raw" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.8)</em></p>
<p>PDF only: Return the <strong>unmodified</strong> (esp. <strong>not decompressed</strong>) contents of the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> stream object. Otherwise equal to <a class="reference internal" href="#Document.xref_stream" title="Document.xref_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_stream()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bytes</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the (original, unmodified) stream of the object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.update_object">
<code class="sig-name descname">update_object</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em>, <em class="sig-param"><span class="n">obj_str</span></em>, <em class="sig-param"><span class="n">page</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.update_object" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.8)</em></p>
<p>PDF only: Replace object definition of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> with the provided string. The xref may also be new, in which case this instruction completes the object definition. If a page object is also given, its links and annotations will be reloaded afterwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number.</p></li>
<li><p><strong>obj_str</strong> (<em>str</em>) – a string containing a valid PDF object definition.</p></li>
<li><p><strong>page</strong> (<a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>) – a page object. If provided, indicates, that annotations of this page should be refreshed (reloaded) to reflect changes incurred with links and / or annotations.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>zero if successful, otherwise an exception will be raised.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.update_stream">
<code class="sig-name descname">update_stream</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xref</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">new</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.update_stream" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.16.8)</em></p>
<p>Replace the stream of an object identified by <em>xref</em>. If the object has no stream, an exception is raised unless <em>new=True</em> is used. The function automatically performs a compress operation (“deflate”) where beneficial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number.</p></li>
<li><p><strong>stream</strong> (<em>bytes|bytearray|BytesIO</em>) – <p>the new content of the stream.</p>
<p><em>(Changed in version 1.14.13:)</em> <em>io.BytesIO</em> objects are now also supported.</p>
</p></li>
<li><p><strong>new</strong> (<em>bool</em>) – <p>whether to force accepting the stream, and thus <strong>turning it into a stream object</strong>.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The object of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> must be a PDF dictionary for this to work, and especially must not be empty – as is the case if you just created the xref via <a class="reference internal" href="functions.html#Document.get_new_xref" title="Document.get_new_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_new_xref()</span></code></a>. To avoid this, execute <code class="docutils literal notranslate"><span class="pre">doc.update_object(xref,</span> <span class="pre">&quot;&lt;&lt;&gt;&gt;&quot;)</span></code> before inserting the stream.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
<p>This method is intended to manipulate streams containing PDF operator syntax (see pp. 985 of the <a class="reference internal" href="app4.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>) as it is the case for e.g. page content streams.</p>
<p>If you update a contents stream, you should use save parameter <em>clean=True</em>. This ensures consistency between PDF operator source and the object structure.</p>
<p>Example: Let us assume that you no longer want a certain image appear on a page. This can be achieved by deleting the respective reference in its contents source(s) – and indeed: the image will be gone after reloading the page. But the page’s <a class="reference internal" href="glossary.html#resources" title="resources"><code class="xref py py-data docutils literal notranslate"><span class="pre">resources</span></code></a> object would still show the image as being referenced by the page. This save option will clean up any such mismatches.</p>
</dd></dl>

<dl class="py method">
<dt id="Document.has_links">
<code class="sig-name descname">has_links</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.has_links" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="Document.has_annots">
<code class="sig-name descname">has_annots</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.has_annots" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.7)</em></p>
<p>PDF only: Check whether there are links, resp. annotations anywhere in the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>True</em> / <em>False</em>. As opposed to fields, which are stored in a central place of a PDF document, the existence of links / annotations can only be detected by parsing each page. These methods are tuned to do this efficiently and will immediately return, if the answer is <em>True</em> for a page. For PDFs with many thousand pages however, an answer may take some time <a class="footnote-reference brackets" href="#f6" id="id12">6</a> if no link, resp. no annotation is found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="Document.subset_fonts">
<code class="sig-name descname">subset_fonts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.subset_fonts" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.7, changed in v1.18.9)</em></p>
<p>PDF only: <strong>Experimental:</strong> Investigate eligible fonts for their use by text in the document. If a font is supported and a size reduction is possible, that font is replaced by a version with a character subset.</p>
<p>Use this method immediately before saving the document. The following features and restrictions apply for the time being:</p>
<ul class="simple">
<li><p>Package <a class="reference external" href="https://pypi.org/project/fonttools/">fontTools</a> <strong>must be installed</strong>. It is required for creating the font subsets.</p></li>
<li><p>Supported font types only include embedded OTF, TTF and WOFF that are <strong>not already subsets</strong>.</p></li>
<li><p>The script directory must be available for writing temporary files during the subsetting process.</p></li>
<li><p><strong>Changed in v1.18.9:</strong> A subset font directly replaces its original – text remains untouched and <strong>is not rewritten.</strong> It thus should retain all its properties, like spacing, hiddenness, control by Optional Content, etc.</p></li>
</ul>
<p>The greatest benefit can be achieved when creating new PDFs using large fonts like is typical for Asian scripts. In these cases, the set of actually used unicodes mostly is small compared to the number of glyphs in the font. Using this feature can easily reduce the embedded font binary by two orders of magnitude – from several megabytes to a low two-digit kilobyte amount.</p>
</dd></dl>

<dl class="py attribute">
<dt id="Document.outline">
<code class="sig-name descname">outline</code><a class="headerlink" href="#Document.outline" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the first <a class="reference internal" href="outline.html#outline"><span class="std std-ref">Outline</span></a> entry of the document (or <em>None</em>). Can be used as a starting point to walk through all outline items. Accessing this property for encrypted, not authenticated documents will raise an <em>AttributeError</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="outline.html#outline"><span class="std std-ref">Outline</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.is_closed">
<code class="sig-name descname">is_closed</code><a class="headerlink" href="#Document.is_closed" title="Permalink to this definition">¶</a></dt>
<dd><p><em>False</em> if document is still open. If closed, most other attributes and methods will have been deleted / disabled. In addition, <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> objects referring to this document (i.e. created with <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a>) and their dependent objects will no longer be usable. For reference purposes, <a class="reference internal" href="#Document.name" title="Document.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.name</span></code></a> still exists and will contain the filename of the original document (if applicable).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.is_dirty">
<code class="sig-name descname">is_dirty</code><a class="headerlink" href="#Document.is_dirty" title="Permalink to this definition">¶</a></dt>
<dd><p><em>True</em> if this is a PDF document and contains unsaved changes, else <em>False</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.is_pdf">
<code class="sig-name descname">is_pdf</code><a class="headerlink" href="#Document.is_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p><em>True</em> if this is a PDF document, else <em>False</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id0">
<code class="sig-name descname">is_pdf</code><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p><em>True</em> if this is a PDF document, else <em>False</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.is_form_pdf">
<code class="sig-name descname">is_form_pdf</code><a class="headerlink" href="#Document.is_form_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p><em>False</em> if this is not a PDF or has no form fields, otherwise the number of root form fields (fields with no ancestors).</p>
<p><em>(Changed in version 1.16.4)</em> Returns the total number of (root) form fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool,int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.is_reflowable">
<code class="sig-name descname">is_reflowable</code><a class="headerlink" href="#Document.is_reflowable" title="Permalink to this definition">¶</a></dt>
<dd><p><em>True</em> if document has a variable page layout (like e-books or HTML). In this case you can set the desired page dimensions during document creation (open) or via method <a class="reference internal" href="#Document.layout" title="Document.layout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.is_repaired">
<code class="sig-name descname">is_repaired</code><a class="headerlink" href="#Document.is_repaired" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in v1.18.2)</em></p>
<p><em>True</em> if PDF has been repaired during open (because of major structure issues). Always <em>False</em> for non-PDF documents. If true, more details have been stored in <code class="docutils literal notranslate"><span class="pre">TOOLS.mupdf_warnings()</span></code>, and <a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a> will return <em>False</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.needs_pass">
<code class="sig-name descname">needs_pass</code><a class="headerlink" href="#Document.needs_pass" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether the document is password-protected against access. This indicator remains unchanged – <strong>even after the document has been authenticated</strong>. Precludes incremental saves if true.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.is_encrypted">
<code class="sig-name descname">is_encrypted</code><a class="headerlink" href="#Document.is_encrypted" title="Permalink to this definition">¶</a></dt>
<dd><p>This indicator initially equals <a class="reference internal" href="#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a>. After successful authentication, it is set to <em>False</em> to reflect the situation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.permissions">
<code class="sig-name descname">permissions</code><a class="headerlink" href="#Document.permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the permissions to access the document. This is an integer containing bool values in respective bit positions. For example, if <em>doc.permissions &amp; fitz.PDF_PERM_MODIFY &gt; 0</em>, you may change the document. See <a class="reference internal" href="vars.html#permissioncodes"><span class="std std-ref">Document Permissions</span></a> for details.</p>
<p>Changed in version 1.16.0 This is now an integer comprised of bit indicators. Was a dictionary previously.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.metadata">
<code class="sig-name descname">metadata</code><a class="headerlink" href="#Document.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the document’s meta data as a Python dictionary or <em>None</em> (if <em>is_encrypted=True</em> and <em>needPass=True</em>). Keys are <em>format</em>, <em>encryption</em>, <em>title</em>, <em>author</em>, <em>subject</em>, <em>keywords</em>, <em>creator</em>, <em>producer</em>, <em>creationDate</em>, <em>modDate</em>, <em>trapped</em>. All item values are strings or <em>None</em>.</p>
<p>Except <em>format</em> and <em>encryption</em>, for PDF documents, the key names correspond in an obvious way to the PDF keys <em>/Creator</em>, <em>/Producer</em>, <em>/CreationDate</em>, <em>/ModDate</em>, <em>/Title</em>, <em>/Author</em>, <em>/Subject</em>, <em>/Trapped</em> and <em>/Keywords</em> respectively.</p>
<ul>
<li><p><em>format</em> contains the document format (e.g. ‘PDF-1.6’, ‘XPS’, ‘EPUB’).</p></li>
<li><p><em>encryption</em> either contains <em>None</em> (no encryption), or a string naming an encryption method (e.g. <em>‘Standard V4 R4 128-bit RC4’</em>). Note that an encryption method may be specified <strong>even if</strong> <em>needs_pass=False</em>. In such cases not all permissions will probably have been granted. Check <a class="reference internal" href="#Document.permissions" title="Document.permissions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.permissions</span></code></a> for details.</p></li>
<li><p>If the date fields contain valid data (which need not be the case at all!), they are strings in the PDF-specific timestamp format “D:&lt;TS&gt;&lt;TZ&gt;”, where</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;TS&gt; is the 12 character ISO timestamp <em>YYYYMMDDhhmmss</em> (<em>YYYY</em> - year, <em>MM</em> - month, <em>DD</em> - day, <em>hh</em> - hour, <em>mm</em> - minute, <em>ss</em> - second), and</p></li>
<li><p>&lt;TZ&gt; is a time zone value (time intervall relative to GMT) containing a sign (‘+’ or ‘-‘), the hour (<em>hh</em>), and the minute (<em>‘mm’</em>, note the apostrophies!).</p></li>
</ul>
</div></blockquote>
</li>
<li><p>A Paraguayan value might hence look like <em>D:20150415131602-04’00’</em>, which corresponds to the timestamp April 15, 2015, at 1:16:02 pm local time Asuncion.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#Document.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the <em>filename</em> or <em>filetype</em> value with which <em>Document</em> was created.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.page_count">
<code class="sig-name descname">page_count</code><a class="headerlink" href="#Document.page_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the number of pages of the document. May return 0 for documents with no pages. Function <em>len(doc)</em> will also deliver this result.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.chapter_count">
<code class="sig-name descname">chapter_count</code><a class="headerlink" href="#Document.chapter_count" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.17.0)</em>
Contains the number of chapters in the document. Always at least 1. Relevant only for document types with chapter support (EPUB currently). Other documents will return 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.last_location">
<code class="sig-name descname">last_location</code><a class="headerlink" href="#Document.last_location" title="Permalink to this definition">¶</a></dt>
<dd><p><em>(New in version 1.17.0)</em>
Contains (chapter, pno) of the document’s last page. Relevant only for document types with chapter support (EPUB currently). Other documents will return <em>(0, len(doc) - 1)</em> and <em>(0, -1)</em> if it has no pages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="Document.FormFonts">
<code class="sig-name descname">FormFonts</code><a class="headerlink" href="#Document.FormFonts" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of form field font names defined in the <em>/AcroForm</em> object. <em>None</em> if not a PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For methods that change the structure of a PDF (<code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">select()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code> and others), be aware that objects or properties in your program may have been invalidated or orphaned. Examples are <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> objects and their children (links, annotations, widgets), variables holding old page counts, tables of content and the like. Remember to keep such variables up to date or delete orphaned objects. Also refer to <a class="reference internal" href="app4.html#referenialintegrity"><span class="std std-ref">Ensuring Consistency of Important Objects in PyMuPDF</span></a>.</p>
</div>
<div class="section" id="set-metadata-example">
<h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_metadata()</span></code> Example<a class="headerlink" href="#set-metadata-example" title="Permalink to this headline">¶</a></h2>
<p>Clear metadata information. If you do this out of privacy / data protection concerns, make sure you save the document as a new file with <em>garbage &gt; 0</em>. Only then the old <em>/Info</em> object will also be physically removed from the file. In this case, you may also want to clear any XML metadata inserted by several PDF editors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fitz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>             <span class="c1"># look at what we currently have</span>
<span class="go">{&#39;producer&#39;: &#39;rst2pdf, reportlab&#39;, &#39;format&#39;: &#39;PDF 1.4&#39;, &#39;encryption&#39;: None, &#39;author&#39;:</span>
<span class="go">&#39;Jorj X. McKie&#39;, &#39;modDate&#39;: &quot;D:20160611145816-04&#39;00&#39;&quot;, &#39;keywords&#39;: &#39;PDF, XPS, EPUB, CBZ&#39;,</span>
<span class="go">&#39;title&#39;: &#39;The PyMuPDF Documentation&#39;, &#39;creationDate&#39;: &quot;D:20160611145816-04&#39;00&#39;&quot;,</span>
<span class="go">&#39;creator&#39;: &#39;sphinx&#39;, &#39;subject&#39;: &#39;PyMuPDF 1.9.1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">({})</span>      <span class="c1"># clear all fields</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>             <span class="c1"># look again to show what happened</span>
<span class="go">{&#39;producer&#39;: &#39;none&#39;, &#39;format&#39;: &#39;PDF 1.4&#39;, &#39;encryption&#39;: None, &#39;author&#39;: &#39;none&#39;,</span>
<span class="go">&#39;modDate&#39;: &#39;none&#39;, &#39;keywords&#39;: &#39;none&#39;, &#39;title&#39;: &#39;none&#39;, &#39;creationDate&#39;: &#39;none&#39;,</span>
<span class="go">&#39;creator&#39;: &#39;none&#39;, &#39;subject&#39;: &#39;none&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">_delXmlMetadata</span><span class="p">()</span>    <span class="c1"># clear any XML metadata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;anonymous.pdf&quot;</span><span class="p">,</span> <span class="n">garbage</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>       <span class="c1"># save anonymized doc</span>
</pre></div>
</div>
</div>
<div class="section" id="set-toc-demonstration">
<h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_toc()</span></code> Demonstration<a class="headerlink" href="#set-toc-demonstration" title="Permalink to this headline">¶</a></h2>
<p>This shows how to modify or add a table of contents. Also have a look at <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/csv2toc.py">csv2toc.py</a> and <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/toc2csv.py">toc2csv.py</a> in the examples directory.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fitz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">toc</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                           <span class="c1"># show what we have</span>
<span class="go">[1, &#39;The PyMuPDF Documentation&#39;, 1]</span>
<span class="go">[2, &#39;Introduction&#39;, 1]</span>
<span class="go">[3, &#39;Note on the Name fitz&#39;, 1]</span>
<span class="go">[3, &#39;License&#39;, 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot; modified by set_toc&quot;</span>               <span class="c1"># modify something</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc</span><span class="p">)</span>                                  <span class="c1"># replace outline tree</span>
<span class="go">3                                                    # number of bookmarks inserted</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                  <span class="c1"># demonstrate it worked</span>
<span class="go">[1, &#39;The PyMuPDF Documentation&#39;, 1]</span>
<span class="go">[2, &#39;Introduction modified by set_toc&#39;, 1]            # &lt;&lt;&lt; this has changed</span>
<span class="go">[3, &#39;Note on the Name fitz&#39;, 1]</span>
<span class="go">[3, &#39;License&#39;, 1]</span>
</pre></div>
</div>
</div>
<div class="section" id="insert-pdf-examples">
<h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code> Examples<a class="headerlink" href="#insert-pdf-examples" title="Permalink to this headline">¶</a></h2>
<p><strong>(1) Concatenate two documents including their TOCs:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file1.pdf&quot;</span><span class="p">)</span>          <span class="c1"># must be a PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc2</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file2.pdf&quot;</span><span class="p">)</span>          <span class="c1"># must be a PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pages1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span>                     <span class="c1"># save doc1&#39;s page count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc1</span> <span class="o">=</span> <span class="n">doc1</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>     <span class="c1"># save TOC 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc2</span> <span class="o">=</span> <span class="n">doc2</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>     <span class="c1"># save TOC 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>                   <span class="c1"># doc2 at end of doc1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">toc2</span><span class="p">:</span>                         <span class="c1"># increase toc2 page numbers</span>
<span class="go">        t[2] += pages1                     # by old len(doc1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc1</span> <span class="o">+</span> <span class="n">toc2</span><span class="p">)</span>               <span class="c1"># now result has total TOC</span>
</pre></div>
</div>
<p>Obviously, similar ways can be found in more general situations. Just make sure that hierarchy levels in a row do not increase by more than one. Inserting dummy bookmarks before and after <em>toc2</em> segments would heal such cases. A ready-to-use GUI (wxPython) solution can be found in script <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/PDFjoiner.py">PDFjoiner.py</a> of the examples directory.</p>
<p><strong>(2) More examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># insert 5 pages of doc2, where its page 21 becomes page 15 in doc1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># same example, but pages are rotated and copied in reverse order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># put copied pages in front of doc1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="other-examples">
<h2>Other Examples<a class="headerlink" href="#other-examples" title="Permalink to this headline">¶</a></h2>
<p><strong>Extract all page-referenced images of a PDF into separate PNG files</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span>
    <span class="n">imglist</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_page_images</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">imglist</span><span class="p">:</span>
        <span class="n">xref</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                  <span class="c1"># xref number</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">xref</span><span class="p">)</span>   <span class="c1"># make pixmap from image</span>
        <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>      <span class="c1"># can be saved as PNG</span>
            <span class="n">pix</span><span class="o">.</span><span class="n">writePNG</span><span class="p">(</span><span class="s2">&quot;p</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xref</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>                          <span class="c1"># CMYK: must convert first</span>
            <span class="n">pix0</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">fitz</span><span class="o">.</span><span class="n">csRGB</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span>
            <span class="n">pix0</span><span class="o">.</span><span class="n">writePNG</span><span class="p">(</span><span class="s2">&quot;p</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xref</span><span class="p">))</span>
            <span class="n">pix0</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1"># free Pixmap resources</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="kc">None</span>                     <span class="c1"># free Pixmap resources</span>
</pre></div>
</div>
<p><strong>Rotate all pages of a PDF:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id9">1</a></span></dt>
<dd><p>Content streams describe what (e.g. text or images) appears where and how on a page. PDF uses a specialized mini language similar to PostScript to do this (pp. 985 in <a class="reference internal" href="app4.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>), which gets interpreted when a page is loaded.</p>
</dd>
<dt class="label" id="f2"><span class="brackets"><a class="fn-backref" href="#id8">2</a></span></dt>
<dd><p>However, you <strong>can</strong> use <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> and <a class="reference internal" href="page.html#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a> (which are available for all document types) and copy this information over to the output PDF. See demo <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/demo/pdf-converter.py">pdf-converter.py</a>.</p>
</dd>
<dt class="label" id="f3"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>For applicable (EPUB) document types, loading a page via its absolute number may result in layouting a large part of the document, before the page can be accessed. To avoid this performance impact, prefer chapter-based access. Use convenience methods / attributes <a class="reference internal" href="#Document.next_location" title="Document.next_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a>, <a class="reference internal" href="#Document.prev_location" title="Document.prev_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a> and <a class="reference internal" href="#Document.last_location" title="Document.last_location"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.last_location</span></code></a> for maintaining a high level of coding efficiency.</p>
</dd>
<dt class="label" id="f4"><span class="brackets">4</span><span class="fn-backref">(<a href="#id10">1</a>,<a href="#id11">2</a>)</span></dt>
<dd><p>These parameters cause separate handling of stream categories: use it together with <code class="docutils literal notranslate"><span class="pre">expand</span></code> to restrict decompression to streams other than images / fontfiles.</p>
</dd>
<dt class="label" id="f5"><span class="brackets"><a class="fn-backref" href="#id2">5</a></span></dt>
<dd><p>Examples for “Form XObjects” are created by <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>.</p>
</dd>
<dt class="label" id="f6"><span class="brackets"><a class="fn-backref" href="#id12">6</a></span></dt>
<dd><p>For a <em>False</em> the <strong>complete document</strong> must be scanned. Both methods <strong>do not load pages,</strong> but only scan object definitions. This makes them at least 10 times faster than application-level loops (where total response time roughly equals the time for loading all pages). For the <a class="reference internal" href="app4.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> (1’310 pages) and the Pandas documentation (over 3’070 pages) – both havo no annotations – the method needs about 11 ms for the answer <em>False</em>. So response times will probably become significant only well beyond this order of magnitude.</p>
</dd>
</dl>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Document</a><ul>
<li><a class="reference internal" href="#set-metadata-example"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_metadata()</span></code> Example</a></li>
<li><a class="reference internal" href="#set-toc-demonstration"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_toc()</span></code> Demonstration</a></li>
<li><a class="reference internal" href="#insert-pdf-examples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code> Examples</a></li>
<li><a class="reference internal" href="#other-examples">Other Examples</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="displaylist.html"
                        title="previous chapter">DisplayList</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="font.html"
                        title="next chapter">Font</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="font.html" title="Font"
             >next</a> |</li>
        <li class="right" >
          <a href="displaylist.html" title="DisplayList"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PyMuPDF 1.18.9 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="classes.html" >Classes</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Document</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015-2021, Jorj X. McKie.
      Last updated on 10. Feb 2021.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>